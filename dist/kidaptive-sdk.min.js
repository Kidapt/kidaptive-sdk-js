(function e(t,r){if(typeof exports==="object"&&typeof module==="object")module.exports=r();else if(typeof define==="function"&&define.amd)define("kidaptive-sdk-js",[],r);else if(typeof exports==="object")exports["kidaptive-sdk-js"]=r();else t["KidaptiveSdk"]=r()})(window,function(){return function(e){var t={};function r(n){if(t[n]){return t[n].exports}var i=t[n]={i:n,l:false,exports:{}};e[n].call(i.exports,i,i.exports,r);i.l=true;return i.exports}r.m=e;r.c=t;r.d=function(e,t,n){if(!r.o(e,t)){Object.defineProperty(e,t,{configurable:false,enumerable:true,get:n})}};r.r=function(e){Object.defineProperty(e,"__esModule",{value:true})};r.n=function(e){var t=e&&e.__esModule?function t(){return e["default"]}:function t(){return e};r.d(t,"a",t);return t};r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};r.p="";return r(r.s=37)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var a=m(i);var o=r(1);var u=m(o);var s=r(6);var l=m(s);var f=r(2);var c=m(f);var d=r(35);var h=m(d);var p=r(34);var v=m(p);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var g=function(){function e(){y(this,e)}n(e,[{key:"checkInitialized",value:function e(t){if(!c.default.get("initialized")){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"SDK not initialized")}}},{key:"checkTier",value:function e(t){this.checkInitialized();var r=c.default.get("options")||{};if(r.tier<t){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"SDK not configured to tier "+t)}}},{key:"checkAuthMode",value:function e(t){this.checkInitialized();var r=c.default.get("options")||{};if(r.authMode!==t){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"SDK not configured to authMode "+t)}}},{key:"checkLoggingLevel",value:function e(t){var r={all:3,warn:2,none:1};var n=c.default.get("options")||{};var i=n.loggingLevel||a.default.DEFAULT.LOGGING_LEVEL;return r[i]>=r[t]}},{key:"copyObject",value:function e(t){return(0,h.default)(t)}},{key:"findItem",value:function e(t,r){for(var n=0;n<t.length;n++){if(r(t[n])){return t[n]}}return}},{key:"findItemIndex",value:function e(t,r){for(var n=0;n<t.length;n++){if(r(t[n])){return n}}return-1}},{key:"isArray",value:function e(t){return Object.prototype.toString.call(t)==="[object Array]"}},{key:"isBoolean",value:function e(t){return typeof t==="boolean"}},{key:"isFunction",value:function e(t){return Object.prototype.toString.call(t)==="[object Function]"}},{key:"isJson",value:function e(t){if(!this.isString(t)){return false}try{JSON.parse(t);return true}catch(e){return false}}},{key:"isNumber",value:function e(t){return Object.prototype.toString.call(t)==="[object Number]"}},{key:"isInteger",value:function e(t){return this.isNumber(t)&&isFinite(t)&&Math.floor(t)===t}},{key:"isObject",value:function e(t){return t===Object(t)&&Object.prototype.toString.call(t)!=="[object Array]"&&Object.prototype.toString.call(t)!=="[object Function]"}},{key:"isString",value:function e(t){return Object.prototype.toString.call(t)==="[object String]"}},{key:"localStorageGetItem",value:function e(t){var r=localStorage.getItem(t);if(r===null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"No item found for key "+t+" in localStorage")}return r==="undefined"?undefined:JSON.parse(r)}},{key:"localStorageGetKeys",value:function e(){try{return Object.keys(localStorage)}catch(e){return[]}}},{key:"localStorageRemoveItem",value:function e(t){try{localStorage.removeItem(t)}catch(e){}}},{key:"localStorageSetItem",value:function t(r,n){var i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;try{localStorage.setItem(r,i?JSON.stringify(n):n)}catch(t){if(e.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: ALP SDK unable to write to localStorage. Cached data may be inconsistent or out-of-date")}}}},{key:"toJson",value:function e(t){return(0,v.default)(t)}},{key:"clearUserCache",value:function e(){var t=this;this.localStorageGetKeys().forEach(function(e){if(e.match(/^[\w-.]*[.]alpUserData$/)){t.localStorageRemoveItem(e)}})}},{key:"clearAppCache",value:function e(){var t=this;this.localStorageGetKeys().forEach(function(e){if(e.match(/^[\w-.]*[.]alpAppData$/)){t.localStorageRemoveItem(e)}})}},{key:"cacheUser",value:function e(t){this.localStorageSetItem("User."+c.default.get("apiKey")+a.default.CACHE_KEY.USER,t)}},{key:"cacheLearnerId",value:function e(t){this.localStorageSetItem("LearnerId."+c.default.get("apiKey")+a.default.CACHE_KEY.USER,t)}},{key:"cacheSingletonLearnerFlag",value:function e(t){this.localStorageSetItem("SingletonLearnerFlag."+c.default.get("apiKey")+a.default.CACHE_KEY.USER,t)}},{key:"cacheLatentAbilityEstimates",value:function e(t){var r=c.default.get("learnerId");var n=this.copyObject(t);n.forEach(function(e){e.dimensionId=e.dimension&&e.dimension.id;delete e.dimension});var i=l.default.getCacheKey(l.default.getRequestSettings("GET",a.default.ENDPOINT.ABILITY,{learnerId:r}));this.localStorageSetItem(i,n)}},{key:"getCachedUser",value:function e(){try{return this.localStorageGetItem("User."+c.default.get("apiKey")+a.default.CACHE_KEY.USER)}catch(e){}}},{key:"getCachedLearnerId",value:function e(){try{return this.localStorageGetItem("LearnerId."+c.default.get("apiKey")+a.default.CACHE_KEY.USER)}catch(e){}}},{key:"getCachedSingletonLearnerFlag",value:function e(){try{return this.localStorageGetItem("SingletonLearnerFlag."+c.default.get("apiKey")+a.default.CACHE_KEY.USER)}catch(e){return true}}}]);return e}();t.default=new g},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var i=function e(t,r){n(this,e);var i=new Error("KidaptiveError ("+t+") "+r);i.type=t;return i};i.ERROR_CODES={GENERIC_ERROR:"GENERIC_ERROR",INVALID_PARAMETER:"INVALID_PARAMETER",ILLEGAL_STATE:"ILLEGAL_STATE",API_KEY_ERROR:"API_KEY_ERROR",WEB_API_ERROR:"WEB_API_ERROR"};t.default=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var a=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var s=void 0;var l=function(){function e(){u(this,e);s={}}n(e,[{key:"get",value:function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:true;return r?a.default.copyObject(s[t]):s[t]}},{key:"set",value:function e(t,r){var n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;s[t]=n?a.default.copyObject(r):r}},{key:"clear",value:function e(){s={}}}]);return e}();t.default=new l},function(e,t,r){(function(t,r){(function(t){"use strict";if(typeof bootstrap==="function"){bootstrap("promise",t)}else if(true){e.exports=t()}else{var r,n}})(function(){"use strict";var e=false;try{throw new Error}catch(t){e=!!t.stack}var n=I();var i;var a=function(){};var o=function(){var e={task:void 0,next:null};var n=e;var i=false;var a=void 0;var u=false;var s=[];function l(){var t,r;while(e.next){e=e.next;t=e.task;e.task=void 0;r=e.domain;if(r){e.domain=void 0;r.enter()}f(t,r)}while(s.length){t=s.pop();f(t)}i=false}function f(e,t){try{e()}catch(e){if(u){if(t){t.exit()}setTimeout(l,0);if(t){t.enter()}throw e}else{setTimeout(function(){throw e},0)}}if(t){t.exit()}}o=function(e){n=n.next={task:e,domain:u&&t.domain,next:null};if(!i){i=true;a()}};if(typeof t==="object"&&t.toString()==="[object process]"&&t.nextTick){u=true;a=function(){t.nextTick(l)}}else if(typeof r==="function"){if(typeof window!=="undefined"){a=r.bind(window,l)}else{a=function(){r(l)}}}else if(typeof MessageChannel!=="undefined"){var c=new MessageChannel;c.port1.onmessage=function(){a=d;c.port1.onmessage=l;l()};var d=function(){c.port2.postMessage(0)};a=function(){setTimeout(l,0);d()}}else{a=function(){setTimeout(l,0)}}o.runAfter=function(e){s.push(e);if(!i){i=true;a()}};return o}();var u=Function.call;function s(e){return function(){return u.apply(e,arguments)}}var l=s(Array.prototype.slice);var f=s(Array.prototype.reduce||function(e,t){var r=0,n=this.length;if(arguments.length===1){do{if(r in this){t=this[r++];break}if(++r>=n){throw new TypeError}}while(1)}for(;r<n;r++){if(r in this){t=e(t,this[r],r)}}return t});var c=s(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++){if(this[t]===e){return t}}return-1});var d=s(Array.prototype.map||function(e,t){var r=this;var n=[];f(r,function(i,a,o){n.push(e.call(t,a,o,r))},void 0);return n});var h=Object.create||function(e){function t(){}t.prototype=e;return new t};var p=Object.defineProperty||function(e,t,r){e[t]=r.value;return e};var v=s(Object.prototype.hasOwnProperty);var m=Object.keys||function(e){var t=[];for(var r in e){if(v(e,r)){t.push(r)}}return t};var y=s(Object.prototype.toString);function g(e){return e===Object(e)}function E(e){return y(e)==="[object StopIteration]"||e instanceof R}var R;if(typeof ReturnValue!=="undefined"){R=ReturnValue}else{R=function(e){this.value=e}}var _="From previous event:";function b(t,r){if(e&&r.stack&&typeof t==="object"&&t!==null&&t.stack){var n=[];for(var i=r;!!i;i=i.source){if(i.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>i.stackCounter)){p(t,"__minimumStackCounter__",{value:i.stackCounter,configurable:true});n.unshift(i.stack)}}n.unshift(t.stack);var a=n.join("\n"+_+"\n");var o=w(a);p(t,"stack",{value:o,configurable:true})}}function w(e){var t=e.split("\n");var r=[];for(var n=0;n<t.length;++n){var i=t[n];if(!T(i)&&!A(i)&&i){r.push(i)}}return r.join("\n")}function A(e){return e.indexOf("(module.js:")!==-1||e.indexOf("(node.js:")!==-1}function O(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t){return[t[1],Number(t[2])]}var r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(r){return[r[1],Number(r[2])]}var n=/.*@(.+):(\d+)$/.exec(e);if(n){return[n[1],Number(n[2])]}}function T(e){var t=O(e);if(!t){return false}var r=t[0];var a=t[1];return r===i&&a>=n&&a<=ce}function I(){if(!e){return}try{throw new Error}catch(e){var t=e.stack.split("\n");var r=t[0].indexOf("@")>0?t[1]:t[2];var n=O(r);if(!n){return}i=n[0];return n[1]}}function S(e,t,r){return function(){if(typeof console!=="undefined"&&typeof console.warn==="function"){console.warn(t+" is deprecated, use "+r+" instead.",new Error("").stack)}return e.apply(e,arguments)}}function k(e){if(e instanceof P){return e}if(H(e)){return Y(e)}else{return J(e)}}k.resolve=k;k.nextTick=o;k.longStackSupport=false;var L=1;if(typeof t==="object"&&t&&t.env&&t.env.Q_DEBUG){k.longStackSupport=true}k.defer=D;function D(){var t=[],r=[],n;var i=h(D.prototype);var a=h(P.prototype);a.promiseDispatch=function(e,i,a){var o=l(arguments);if(t){t.push(o);if(i==="when"&&a[1]){r.push(a[1])}}else{k.nextTick(function(){n.promiseDispatch.apply(n,o)})}};a.valueOf=function(){if(t){return a}var e=N(n);if(x(e)){n=e}return e};a.inspect=function(){if(!n){return{state:"pending"}}return n.inspect()};if(k.longStackSupport&&e){try{throw new Error}catch(e){a.stack=e.stack.substring(e.stack.indexOf("\n")+1);a.stackCounter=L++}}function o(i){n=i;if(k.longStackSupport&&e){a.source=i}f(t,function(e,t){k.nextTick(function(){i.promiseDispatch.apply(i,t)})},void 0);t=void 0;r=void 0}i.promise=a;i.resolve=function(e){if(n){return}o(k(e))};i.fulfill=function(e){if(n){return}o(J(e))};i.reject=function(e){if(n){return}o(z(e))};i.notify=function(e){if(n){return}f(r,function(t,r){k.nextTick(function(){r(e)})},void 0)};return i}D.prototype.makeNodeResolver=function(){var e=this;return function(t,r){if(t){e.reject(t)}else if(arguments.length>2){e.resolve(l(arguments,1))}else{e.resolve(r)}}};k.Promise=C;k.promise=C;function C(e){if(typeof e!=="function"){throw new TypeError("resolver must be a function.")}var t=D();try{e(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}return t.promise}C.race=j;C.all=ae;C.reject=z;C.resolve=k;k.passByCopy=function(e){return e};P.prototype.passByCopy=function(){return this};k.join=function(e,t){return k(e).join(t)};P.prototype.join=function(e){return k([this,e]).spread(function(e,t){if(e===t){return e}else{throw new Error("Q can't join: not the same: "+e+" "+t)}})};k.race=j;function j(e){return C(function(t,r){for(var n=0,i=e.length;n<i;n++){k(e[n]).then(t,r)}})}P.prototype.race=function(){return this.then(k.race)};k.makePromise=P;function P(e,t,r){if(t===void 0){t=function(e){return z(new Error("Promise does not support operation: "+e))}}if(r===void 0){r=function(){return{state:"unknown"}}}var n=h(P.prototype);n.promiseDispatch=function(r,i,a){var o;try{if(e[i]){o=e[i].apply(n,a)}else{o=t.call(n,i,a)}}catch(e){o=z(e)}if(r){r(o)}};n.inspect=r;if(r){var i=r();if(i.state==="rejected"){n.exception=i.reason}n.valueOf=function(){var e=r();if(e.state==="pending"||e.state==="rejected"){return n}return e.value}}return n}P.prototype.toString=function(){return"[object Promise]"};P.prototype.then=function(e,t,r){var n=this;var i=D();var a=false;function o(t){try{return typeof e==="function"?e(t):t}catch(e){return z(e)}}function u(e){if(typeof t==="function"){b(e,n);try{return t(e)}catch(e){return z(e)}}return z(e)}function s(e){return typeof r==="function"?r(e):e}k.nextTick(function(){n.promiseDispatch(function(e){if(a){return}a=true;i.resolve(o(e))},"when",[function(e){if(a){return}a=true;i.resolve(u(e))}])});n.promiseDispatch(void 0,"when",[void 0,function(e){var t;var r=false;try{t=s(e)}catch(e){r=true;if(k.onerror){k.onerror(e)}else{throw e}}if(!r){i.notify(t)}}]);return i.promise};k.tap=function(e,t){return k(e).tap(t)};P.prototype.tap=function(e){e=k(e);return this.then(function(t){return e.fcall(t).thenResolve(t)})};k.when=M;function M(e,t,r,n){return k(e).then(t,r,n)}P.prototype.thenResolve=function(e){return this.then(function(){return e})};k.thenResolve=function(e,t){return k(e).thenResolve(t)};P.prototype.thenReject=function(e){return this.then(function(){throw e})};k.thenReject=function(e,t){return k(e).thenReject(t)};k.nearer=N;function N(e){if(x(e)){var t=e.inspect();if(t.state==="fulfilled"){return t.value}}return e}k.isPromise=x;function x(e){return e instanceof P}k.isPromiseAlike=H;function H(e){return g(e)&&typeof e.then==="function"}k.isPending=U;function U(e){return x(e)&&e.inspect().state==="pending"}P.prototype.isPending=function(){return this.inspect().state==="pending"};k.isFulfilled=V;function V(e){return!x(e)||e.inspect().state==="fulfilled"}P.prototype.isFulfilled=function(){return this.inspect().state==="fulfilled"};k.isRejected=F;function F(e){return x(e)&&e.inspect().state==="rejected"}P.prototype.isRejected=function(){return this.inspect().state==="rejected"};var B=[];var q=[];var X=[];var K=true;function G(){B.length=0;q.length=0;if(!K){K=true}}function W(e,r){if(!K){return}if(typeof t==="object"&&typeof t.emit==="function"){k.nextTick.runAfter(function(){if(c(q,e)!==-1){t.emit("unhandledRejection",r,e);X.push(e)}})}q.push(e);if(r&&typeof r.stack!=="undefined"){B.push(r.stack)}else{B.push("(no stack) "+r)}}function Q(e){if(!K){return}var r=c(q,e);if(r!==-1){if(typeof t==="object"&&typeof t.emit==="function"){k.nextTick.runAfter(function(){var n=c(X,e);if(n!==-1){t.emit("rejectionHandled",B[r],e);X.splice(n,1)}})}q.splice(r,1);B.splice(r,1)}}k.resetUnhandledRejections=G;k.getUnhandledReasons=function(){return B.slice()};k.stopUnhandledRejectionTracking=function(){G();K=false};G();k.reject=z;function z(e){var t=P({when:function(t){if(t){Q(this)}return t?t(e):this}},function e(){return this},function t(){return{state:"rejected",reason:e}});W(t,e);return t}k.fulfill=J;function J(e){return P({when:function(){return e},get:function(t){return e[t]},set:function(t,r){e[t]=r},delete:function(t){delete e[t]},post:function(t,r){if(t===null||t===void 0){return e.apply(void 0,r)}else{return e[t].apply(e,r)}},apply:function(t,r){return e.apply(t,r)},keys:function(){return m(e)}},void 0,function t(){return{state:"fulfilled",value:e}})}function Y(e){var t=D();k.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(e){t.reject(e)}});return t.promise}k.master=$;function $(e){return P({isDef:function(){}},function t(r,n){return ie(e,r,n)},function(){return k(e).inspect()})}k.spread=Z;function Z(e,t,r){return k(e).spread(t,r)}P.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)};k.async=ee;function ee(e){return function(){function t(e,t){var a;if(typeof StopIteration==="undefined"){try{a=r[e](t)}catch(e){return z(e)}if(a.done){return k(a.value)}else{return M(a.value,n,i)}}else{try{a=r[e](t)}catch(e){if(E(e)){return k(e.value)}else{return z(e)}}return M(a,n,i)}}var r=e.apply(this,arguments);var n=t.bind(t,"next");var i=t.bind(t,"throw");return n()}}k.spawn=te;function te(e){k.done(k.async(e)())}k["return"]=re;function re(e){throw new R(e)}k.promised=ne;function ne(e){return function(){return Z([this,ae(arguments)],function(t,r){return e.apply(t,r)})}}k.dispatch=ie;function ie(e,t,r){return k(e).dispatch(t,r)}P.prototype.dispatch=function(e,t){var r=this;var n=D();k.nextTick(function(){r.promiseDispatch(n.resolve,e,t)});return n.promise};k.get=function(e,t){return k(e).dispatch("get",[t])};P.prototype.get=function(e){return this.dispatch("get",[e])};k.set=function(e,t,r){return k(e).dispatch("set",[t,r])};P.prototype.set=function(e,t){return this.dispatch("set",[e,t])};k.del=k["delete"]=function(e,t){return k(e).dispatch("delete",[t])};P.prototype.del=P.prototype["delete"]=function(e){return this.dispatch("delete",[e])};k.mapply=k.post=function(e,t,r){return k(e).dispatch("post",[t,r])};P.prototype.mapply=P.prototype.post=function(e,t){return this.dispatch("post",[e,t])};k.send=k.mcall=k.invoke=function(e,t){return k(e).dispatch("post",[t,l(arguments,2)])};P.prototype.send=P.prototype.mcall=P.prototype.invoke=function(e){return this.dispatch("post",[e,l(arguments,1)])};k.fapply=function(e,t){return k(e).dispatch("apply",[void 0,t])};P.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])};k["try"]=k.fcall=function(e){return k(e).dispatch("apply",[void 0,l(arguments,1)])};P.prototype.fcall=function(){return this.dispatch("apply",[void 0,l(arguments)])};k.fbind=function(e){var t=k(e);var r=l(arguments,1);return function e(){return t.dispatch("apply",[this,r.concat(l(arguments))])}};P.prototype.fbind=function(){var e=this;var t=l(arguments);return function r(){return e.dispatch("apply",[this,t.concat(l(arguments))])}};k.keys=function(e){return k(e).dispatch("keys",[])};P.prototype.keys=function(){return this.dispatch("keys",[])};k.all=ae;function ae(e){return M(e,function(e){var t=0;var r=D();f(e,function(n,i,a){var o;if(x(i)&&(o=i.inspect()).state==="fulfilled"){e[a]=o.value}else{++t;M(i,function(n){e[a]=n;if(--t===0){r.resolve(e)}},r.reject,function(e){r.notify({index:a,value:e})})}},void 0);if(t===0){r.resolve(e)}return r.promise})}P.prototype.all=function(){return ae(this)};k.any=oe;function oe(e){if(e.length===0){return k.resolve()}var t=k.defer();var r=0;f(e,function(n,i,a){var o=e[a];r++;M(o,u,s,l);function u(e){t.resolve(e)}function s(e){r--;if(r===0){var n=e||new Error(""+e);n.message="Q can't get fulfillment value from any promise, all "+"promises were rejected. Last error message: "+n.message;t.reject(n)}}function l(e){t.notify({index:a,value:e})}},undefined);return t.promise}P.prototype.any=function(){return oe(this)};k.allResolved=S(ue,"allResolved","allSettled");function ue(e){return M(e,function(e){e=d(e,k);return M(ae(d(e,function(e){return M(e,a,a)})),function(){return e})})}P.prototype.allResolved=function(){return ue(this)};k.allSettled=se;function se(e){return k(e).allSettled()}P.prototype.allSettled=function(){return this.then(function(e){return ae(d(e,function(e){e=k(e);function t(){return e.inspect()}return e.then(t,t)}))})};k.fail=k["catch"]=function(e,t){return k(e).then(void 0,t)};P.prototype.fail=P.prototype["catch"]=function(e){return this.then(void 0,e)};k.progress=le;function le(e,t){return k(e).then(void 0,void 0,t)}P.prototype.progress=function(e){return this.then(void 0,void 0,e)};k.fin=k["finally"]=function(e,t){return k(e)["finally"](t)};P.prototype.fin=P.prototype["finally"]=function(e){if(!e||typeof e.apply!=="function"){throw new Error("Q can't apply finally callback")}e=k(e);return this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})};k.done=function(e,t,r,n){return k(e).done(t,r,n)};P.prototype.done=function(e,r,n){var i=function(e){k.nextTick(function(){b(e,a);if(k.onerror){k.onerror(e)}else{throw e}})};var a=e||r||n?this.then(e,r,n):this;if(typeof t==="object"&&t&&t.domain){i=t.domain.bind(i)}a.then(void 0,i)};k.timeout=function(e,t,r){return k(e).timeout(t,r)};P.prototype.timeout=function(e,t){var r=D();var n=setTimeout(function(){if(!t||"string"===typeof t){t=new Error(t||"Timed out after "+e+" ms");t.code="ETIMEDOUT"}r.reject(t)},e);this.then(function(e){clearTimeout(n);r.resolve(e)},function(e){clearTimeout(n);r.reject(e)},r.notify);return r.promise};k.delay=function(e,t){if(t===void 0){t=e;e=void 0}return k(e).delay(t)};P.prototype.delay=function(e){return this.then(function(t){var r=D();setTimeout(function(){r.resolve(t)},e);return r.promise})};k.nfapply=function(e,t){return k(e).nfapply(t)};P.prototype.nfapply=function(e){var t=D();var r=l(e);r.push(t.makeNodeResolver());this.fapply(r).fail(t.reject);return t.promise};k.nfcall=function(e){var t=l(arguments,1);return k(e).nfapply(t)};P.prototype.nfcall=function(){var e=l(arguments);var t=D();e.push(t.makeNodeResolver());this.fapply(e).fail(t.reject);return t.promise};k.nfbind=k.denodeify=function(e){if(e===undefined){throw new Error("Q can't wrap an undefined function")}var t=l(arguments,1);return function(){var r=t.concat(l(arguments));var n=D();r.push(n.makeNodeResolver());k(e).fapply(r).fail(n.reject);return n.promise}};P.prototype.nfbind=P.prototype.denodeify=function(){var e=l(arguments);e.unshift(this);return k.denodeify.apply(void 0,e)};k.nbind=function(e,t){var r=l(arguments,2);return function(){var n=r.concat(l(arguments));var i=D();n.push(i.makeNodeResolver());function a(){return e.apply(t,arguments)}k(a).fapply(n).fail(i.reject);return i.promise}};P.prototype.nbind=function(){var e=l(arguments,0);e.unshift(this);return k.nbind.apply(void 0,e)};k.nmapply=k.npost=function(e,t,r){return k(e).npost(t,r)};P.prototype.nmapply=P.prototype.npost=function(e,t){var r=l(t||[]);var n=D();r.push(n.makeNodeResolver());this.dispatch("post",[e,r]).fail(n.reject);return n.promise};k.nsend=k.nmcall=k.ninvoke=function(e,t){var r=l(arguments,2);var n=D();r.push(n.makeNodeResolver());k(e).dispatch("post",[t,r]).fail(n.reject);return n.promise};P.prototype.nsend=P.prototype.nmcall=P.prototype.ninvoke=function(e){var t=l(arguments,1);var r=D();t.push(r.makeNodeResolver());this.dispatch("post",[e,t]).fail(r.reject);return r.promise};k.nodeify=fe;function fe(e,t){return k(e).nodeify(t)}P.prototype.nodeify=function(e){if(e){this.then(function(t){k.nextTick(function(){e(null,t)})},function(t){k.nextTick(function(){e(t)})})}else{return this}};k.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ce=I();return k})}).call(this,r(9),r(27).setImmediate)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default={DEFAULT:{AUTH_MODE:"client",AUTO_FLUSH_INTERVAL:6e4,LOGGING_LEVEL:"all",TIER:1},ENDPOINT:{ABILITY:"/ability",CLIENT_SESSION:"/learner/client-session",DIMENSION:"/dimension",GAME:"/game",INGESTION:"/ingestion",INSIGHT:"/insight",LOCAL_ABILITY:"/local-ability",LOCAL_DIMENSION:"/local-dimension",LOGOUT:"/user/logout",METRIC:"/metric"},HOST:{DEV:"https://develop.kidaptive.com/v3",PROD:"https://service.kidaptive.com/v3"},USER_ENDPOINTS:["ABILITY","CLIENT_SESSION","INGESTION","INSIGHT","LOCAL_ABILITY","LOGOUT","METRIC"],CACHE_KEY:{USER:".alpUserData",APP:".alpAppData"}}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(1,eval)("this")}catch(e){if(typeof window==="object")r=window}e.exports=r},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var a=R(i);var o=r(1);var u=R(o);var s=r(2);var l=R(s);var f=r(0);var c=R(f);var d=r(30);var h=R(d);var p=r(29);var v=R(p);var m=r(3);var y=R(m);var g=r(25);var E=R(g);function R(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=function(){function e(){_(this,e)}n(e,[{key:"request",value:function t(r,n,i){var a=this;var o=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};return y.default.fcall(function(){var t=a.getRequestSettings(r,n,i,o);var s=(0,E.default)(t.method,t.host+t.endpoint);s.withCredentials();if(t.method==="POST"){s.send(t.data)}else{s.query(t.data)}if(t.contentType){s.set("Content-Type",t.contentType)}s.set("api-key",t.apiKey);var l=a.getCacheKey(t);try{return s.end().then(function(e){if(!o.noCache){c.default.localStorageSetItem(l,e.body)}return e.body},function(t){var r=t.parse&&"Cannot parse response"||"";var i=t&&(t.status||t.statusCode);var a=t.response&&t.response.text||r;if(i===400){c.default.localStorageRemoveItem(l);throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,a)}else if(i===401){c.default.clearUserCache();if(!e.isUserEndpoint(n)){c.default.clearAppCache()}throw new u.default(u.default.ERROR_CODES.API_KEY_ERROR,a)}else if(i&&(i<200||i>=300)){c.default.localStorageRemoveItem(l);throw new u.default(u.default.ERROR_CODES.WEB_API_ERROR,a)}else{try{return c.default.localStorageGetItem(l)}catch(e){throw new u.default(u.default.ERROR_CODES.GENERIC_ERROR,"HTTP Client Error"+(a?": "+a:""))}}})}catch(e){try{return c.default.localStorageGetItem(l)}catch(t){throw new u.default(u.default.ERROR_CODES.GENERIC_ERROR,"HTTP Client Error"+(e?": "+e:""))}}})}},{key:"getCacheKey",value:function t(r){return h.default.encode(String.fromCharCode.apply(undefined,v.default.array(c.default.toJson(r)))).replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/=+/,"")+(e.isUserEndpoint(r.endpoint)?a.default.CACHE_KEY.USER:a.default.CACHE_KEY.APP)}},{key:"getRequestSettings",value:function t(r,n,i){var a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};var o=l.default.get("apiKey");var u=l.default.get("user");if(e.isUserEndpoint(n)&&u&&u.apiKey&&!a.defaultApiKey){o=u.apiKey}var s={method:r,host:e.getHost(),apiKey:o,endpoint:n,data:i};if(r==="POST"){s.contentType="application/json"}return s}}],[{key:"getHost",value:function e(){var t=l.default.get("options")||{};if(t.environment==="prod"){return a.default.HOST.PROD}if(t.environment==="dev"){return a.default.HOST.DEV}if(t.environment==="custom"){return t.baseUrl}}},{key:"isUserEndpoint",value:function e(t){return c.default.findItemIndex(a.default.USER_ENDPOINTS,function(e){return a.default.ENDPOINT[e]===t})!==-1}}]);return e}();t.default=new b},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(0);var a=s(i);var o=r(3);var u=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(){l(this,e);this.executing=false;this.operationQueue=(0,u.default)(true)}n(e,[{key:"addToQueue",value:function e(t){var r=this;if(this.executing){return u.default.fcall(t)}var n=this.operationQueue.then(function(){r.executing=true;return u.default.fcall(t)});this.operationQueue=n.then(function(){r.executing=false},function(e){r.executing=false;if(a.default.checkLoggingLevel("all")&&console&&console.error){console.error(e)}});return n}}]);return e}();t.default=new f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(6);var a=m(i);var o=r(1);var u=m(o);var s=r(7);var l=m(s);var f=r(2);var c=m(f);var d=r(0);var h=m(d);var p=r(3);var v=m(p);function m(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var g=function(){function e(){var t=this;y(this,e);this.modelParents={tier2:{dimension:[],game:[],"local-dimension":["dimension","game"]},tier3:{dimension:[],game:[],"local-dimension":["dimension","game"],item:["prompt","local-dimension"],prompt:["game"]}};this.modelOrder={};Object.keys(this.modelParents).forEach(function(e){t.modelOrder[e]=[];var r=function r(n){n.forEach(function(n){r(t.modelParents[e][n]);if(t.modelOrder[e].indexOf(n)===-1){t.modelOrder[e].push(n)}})};r(Object.keys(t.modelParents[e]))})}n(e,[{key:"getGames",value:function e(){h.default.checkTier(2);var t=c.default.get("modelListLookup",false)||{};var r=t["game"]||[];return h.default.copyObject(r)}},{key:"getGameByUri",value:function e(t){h.default.checkTier(2);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"gameUri must be a string")}var r=c.default.get("uriToModel",false)||{};var n=r["game"];var i=n&&n[t];return h.default.copyObject(i)}},{key:"getDimensions",value:function e(){h.default.checkTier(2);var t=c.default.get("modelListLookup",false)||{};var r=t["dimension"]||[];return h.default.copyObject(r)}},{key:"getDimensionByUri",value:function e(t){h.default.checkTier(2);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"dimensionUri must be a string")}var r=c.default.get("uriToModel",false)||{};var n=r["dimension"];var i=n&&n[t];return h.default.copyObject(i)}},{key:"getLocalDimensions",value:function e(){h.default.checkTier(2);var t=c.default.get("modelListLookup",false)||{};var r=t["local-dimension"]||[];return h.default.copyObject(r)}},{key:"getLocalDimensionByUri",value:function e(t){h.default.checkTier(2);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"localDimensionUri must be a string")}var r=c.default.get("uriToModel",false)||{};var n=r["local-dimension"];var i=n&&n[t];return h.default.copyObject(i)}},{key:"getItems",value:function e(){h.default.checkTier(3);var t=c.default.get("modelListLookup",false)||{};var r=t["item"]||[];return h.default.copyObject(r)}},{key:"getItemByUri",value:function e(t){h.default.checkTier(3);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"itemUri must be a string")}var r=c.default.get("uriToModel",false)||{};var n=r["item"];var i=n&&n[t];return h.default.copyObject(i)}},{key:"getItemsByPromptUri",value:function e(t){h.default.checkTier(3);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"promptUri must be a string")}var r=c.default.get("modelListLookup",false)||{};var n=r["item"]||[];var i=n.filter(function(e){return e.prompt.uri===t});return h.default.copyObject(i)}},{key:"getPrompts",value:function e(){h.default.checkTier(3);var t=c.default.get("modelListLookup",false)||{};var r=t["prompt"]||[];return h.default.copyObject(r)}},{key:"getPromptByUri",value:function e(t){h.default.checkTier(3);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"promptUri must be a string")}var r=c.default.get("uriToModel",false)||{};var n=r["prompt"];var i=n&&n[t];return h.default.copyObject(i)}},{key:"getPromptsByGameUri",value:function e(t){h.default.checkTier(3);if(!h.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"gameUri must be a string")}var r=c.default.get("modelListLookup",false)||{};var n=r["prompt"]||[];var i=n.filter(function(e){return e.game.uri===t});return h.default.copyObject(i)}},{key:"updateModels",value:function e(){var t=this;return l.default.addToQueue(function(){h.default.checkTier(2);c.default.set("uriToModel",{});c.default.set("idToModel",{});c.default.set("modelListLookup",{});var e=c.default.get("options")||{};var r="tier"+e.tier;var n=t.modelOrder[r];var i=t.modelParents[r];var o=n.map(function(e){return a.default.request("GET","/"+e)});return v.default.all(o).then(function(e){var t={};var r={};var a={};var o=function o(u){var s=n[u];var l={};var f={};var d=[];var p=e[u]||[];p.forEach(function(e){var t=h.default.copyObject(e);i[s].forEach(function(e){var r=e.replace(/-([a-z])/g,function(e){return e[1].toUpperCase()});var n=t[r+"Id"];var i=c.default.get("idToModel",false)||{};t[r]=i[e]&&i[e][n];delete t[r+"Id"]});l[t.uri]=t;f[t.id]=t;d.push(t)});t[s]=l;r[s]=f;a[s]=d;c.default.set("uriToModel",t,false);c.default.set("idToModel",r,false);c.default.set("modelListLookup",a,false)};for(var u=0;u<e.length;u++){o(u)}},function(e){throw e})})}}]);return e}();t.default=new g},function(e,t){var r=e.exports={};var n;var i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){n=setTimeout}else{n=a}}catch(e){n=a}try{if(typeof clearTimeout==="function"){i=clearTimeout}else{i=o}}catch(e){i=o}})();function u(e){if(n===setTimeout){return setTimeout(e,0)}if((n===a||!n)&&setTimeout){n=setTimeout;return setTimeout(e,0)}try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function s(e){if(i===clearTimeout){return clearTimeout(e)}if((i===o||!i)&&clearTimeout){i=clearTimeout;return clearTimeout(e)}try{return i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}var l=[];var f=false;var c;var d=-1;function h(){if(!f||!c){return}f=false;if(c.length){l=c.concat(l)}else{d=-1}if(l.length){p()}}function p(){if(f){return}var e=u(h);f=true;var t=l.length;while(t){c=l;l=[];while(++d<t){if(c){c[d].run()}}d=-1;t=l.length}c=null;f=false;s(e)}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}l.push(new v(e,t));if(l.length===1&&!f){u(p)}};function v(e,t){this.fun=e;this.array=t}v.prototype.run=function(){this.fun.apply(null,this.array)};r.title="browser";r.browser=true;r.env={};r.argv=[];r.version="";r.versions={};function m(){}r.on=m;r.addListener=m;r.once=m;r.off=m;r.removeListener=m;r.removeAllListeners=m;r.emit=m;r.prependListener=m;r.prependOnceListener=m;r.listeners=function(e){return[]};r.binding=function(e){throw new Error("process.binding is not supported")};r.cwd=function(){return"/"};r.chdir=function(e){throw new Error("process.chdir is not supported")};r.umask=function(){return 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(1);var a=f(i);var o=r(2);var u=f(o);var s=r(0);var l=f(s);function f(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var d=function(){function e(){c(this,e)}n(e,[{key:"registerRecommender",value:function t(r,n){l.default.checkTier(2);var i=e.checkRecommender(r);if(i){throw i}if(n==null){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender key is required")}if(!l.default.isString(n)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender key must be a string")}var o=u.default.get("recommenders",false)||{};if(o[n]&&l.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: recommender key already exists, recommender will be replaced.")}o[n]=l.default.copyObject(r);u.default.set("recommenders",o,false)}},{key:"unregisterRecommender",value:function e(t){l.default.checkTier(2);if(t==null){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender key is required")}if(!l.default.isString(t)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender key must be a string")}var r=u.default.get("recommenders",false)||{};if(!r[t]){if(l.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: recommender key does not exist.")}return}delete r[t];u.default.set("recommenders",r,false)}},{key:"getRecommenderKeys",value:function e(){l.default.checkTier(2);var t=u.default.get("recommenders",false)||{};return Object.keys(t)}},{key:"getRecommendation",value:function t(r){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};l.default.checkTier(2);if(n===null){n={}}if(r==null){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender key is required")}if(!l.default.isString(r)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender key must be a string")}if(!l.default.isObject(n)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Parameters must be an object")}var i=u.default.get("recommenders",false)||{};if(!i[r]){return{error:new a.default(a.default.ERROR_CODES.ILLEGAL_STATE,"Recommender for the provided key does not exist")}}var o=i[r].getRecommendation(n);var s=e.checkRecommendationResult(o);if(s){return{error:s}}return o}}],[{key:"checkRecommender",value:function e(t){if(t==null){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender is required")}if(!l.default.isObject(t)){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender must be an object")}if(t.getRecommendation==null){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender.getRecommendation must be defined")}if(!l.default.isFunction(t.getRecommendation)){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Recommender.getRecommendation must be a function")}}},{key:"checkRecommendationResult",value:function e(t){if(t==null){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"No recommendationResult is returned from the recommender")}if(!l.default.isObject(t)){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"The recommendationResult returned from the recommender must be an object")}if(t.error){}else{var r="The recommendationResult returned from the recommender ";if(t.type==null){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,r+"must have a type property")}if(!l.default.isString(t.type)){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,r+"must have a type property that is a string")}if(t.recommendations==null){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,r+"must have a recommendations property")}if(!l.default.isArray(t.recommendations)){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,r+"must have a recommendations property that is an array")}if(t.context!=null){if(!l.default.isObject(t.context)){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,r+"must have a context property that is an object")}var n=false;Object.keys(t.context).forEach(function(e){if(!l.default.isString(t.context[e])){n=true}});if(n){return new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,r+"must have a context property that is an object of key:value pairs with string values")}}}}}]);return e}();t.default=new d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var a=A(i);var o=r(1);var u=A(o);var s=r(14);var l=A(s);var f=r(6);var c=A(f);var d=r(8);var h=A(d);var p=r(7);var v=A(p);var m=r(10);var y=A(m);var g=r(2);var E=A(g);var R=r(0);var _=A(R);var b=r(3);var w=A(b);function A(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var T=function(){function e(){O(this,e)}n(e,[{key:"setUser",value:function t(){var r=this;var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return v.default.addToQueue(function(){_.default.checkTier(1);var t=E.default.get("options")||{};if(t.authMode==="client"){if(n.providerUserId==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"providerUserId is required")}if(!_.default.isString(n.providerUserId)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"providerUserId must be a string")}if(n.providerLearnerId!=null&&!_.default.isString(n.providerLearnerId)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"if providerLearnerId is specified, it must be a string")}if(n.apiKey!=null){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"setUser apiKey not supported when the SDK authMode is cient")}if(n.providerId!=null){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"setUser providerId not supported when the SDK authMode is cient")}if(n.id!=null){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"setUser id not supported when the SDK authMode is cient")}}if(t.authMode==="server"){var i="Invalid object passed to setUser. Please ensure SDK authmode is correct and the object being passed to setUser is correct.";if(n.apiKey==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" ApiKey is required")}if(!_.default.isString(n.apiKey)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" ApiKey must be a string")}if(n.id==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" User ID is required")}if(!_.default.isNumber(n.id)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" User ID must be a number")}if(!_.default.isArray(n.learners)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" Learners must be an array")}n.learners.forEach(function(e){if(!_.default.isObject(e)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" Learner must be an object")}if(e.id==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" Learner ID is required")}if(!_.default.isNumber(e.id)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" Learner ID must be a number")}if(e.providerId==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" Learner ProviderID is required")}if(!_.default.isString(e.providerId)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,i+" Learner ProviderID must be a string")}})}return l.default.flushEventQueue().then(function(){if(t.authMode==="client"){return c.default.request("POST",a.default.ENDPOINT.CLIENT_SESSION,n,{defaultApiKey:true}).then(function(t){if(e.userIdDifferent(t.id)){return r.logout().then(function(){var r=c.default.getCacheKey(c.default.getRequestSettings("POST",a.default.ENDPOINT.CLIENT_SESSION,{providerUserId:n.providerUserId},{defaultApiKey:true}));_.default.localStorageSetItem(r,t);e.onClientSetUserSuccess(t)})}e.onClientSetUserSuccess(t)})}if(t.authMode==="server"){if(e.userIdDifferent(n.id)){return r.logout().then(function(){e.onServerSetUserSuccess(n)})}e.onServerSetUserSuccess(n)}})})}},{key:"selectActiveLearner",value:function e(t){var r=this;return v.default.addToQueue(function(){_.default.checkTier(1);var e=E.default.get("options")||{};var n=E.default.get("user");var i=E.default.get("learnerId");var o=E.default.get("singletonLearner")===false?false:true;if(t==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"providerLearnerId is required")}if(!_.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"providerLearnerId must be a string")}if(e.authMode==="client"){var s=_.default.findItem(r.getLearnerList(),function(e){return e.providerId===t});if(s){E.default.set("learnerId",s.id);_.default.cacheLearnerId(s.id);if(e.tier>=2){return r.updateAbilityEstimates().then(function(){},function(){}).then(function(){return r.startTrial()})}return r.startTrial()}if(o&&i!=null){return r.logout().then(function(){return r.selectActiveLearner(t)})}return c.default.request("POST",a.default.ENDPOINT.CLIENT_SESSION,{providerLearnerId:t,providerUserId:n&&n.providerId},{defaultApiKey:true}).then(function(n){var i=E.default.get("user");if(!o){if(n.learners<1){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"The client session response is missing learner information")}i.learners.push(n.learners[0])}else{i=n;E.default.set("singletonLearner",true);_.default.cacheSingletonLearnerFlag(true)}E.default.set("user",i);var a=_.default.findItem(r.getLearnerList(),function(e){return e.providerId===t});if(!a){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"A learner with that providerLearnerId does not exist")}E.default.set("learnerId",a.id);_.default.cacheUser(i);_.default.cacheLearnerId(a.id);if(e.tier>=2){return r.updateAbilityEstimates().then(function(){},function(){}).then(function(){return r.startTrial()})}return r.startTrial()})}if(e.authMode==="server"){if(!n){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"KidaptiveSdk.leanerManager.setUser must be called before setting an active learner when using server authentication")}var l=_.default.findItem(r.getLearnerList(),function(e){return e.providerId===t});if(!l){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"A learner with that providerLearnerId does not exist")}E.default.set("learnerId",l.id);_.default.cacheLearnerId(l.id);if(e.tier>=2){return r.updateAbilityEstimates().then(function(){return r.startTrial()})}return r.startTrial()}})}},{key:"clearActiveLearner",value:function e(){return v.default.addToQueue(function(){_.default.checkTier(1);var e=E.default.get("options")||{};if(e.authMode==="client"&&E.default.get("singletonLearner")===true){_.default.clearUserCache();E.default.set("user",undefined)}E.default.set("learnerId",undefined);_.default.cacheLearnerId(undefined)})}},{key:"logout",value:function e(){return v.default.addToQueue(function(){_.default.checkTier(1);return l.default.flushEventQueue().then(function(){var e=E.default.get("options")||{};if(e.authMode==="server"&&E.default.get("user")){return c.default.request("POST",a.default.ENDPOINT.LOGOUT,undefined,{noCache:true}).then(function(){},function(){})}}).then(function(){_.default.clearUserCache();E.default.set("learnerId",undefined);E.default.set("user",undefined);E.default.set("singletonLearner",undefined)})})}},{key:"getUser",value:function e(){_.default.checkTier(1);return E.default.get("user")||undefined}},{key:"getActiveLearner",value:function e(){_.default.checkTier(1);var t=E.default.get("learnerId");if(t==null){return}return _.default.findItem(this.getLearnerList(),function(e){return e.id===t})}},{key:"getLearnerList",value:function e(){_.default.checkTier(1);var t=E.default.get("user")||{};return _.default.isArray(t.learners)?t.learners:[]}},{key:"getMetricsByUri",value:function e(t,r,n){return w.default.fcall(function(){_.default.checkTier(1);if(t==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"metricUri is required")}if(!_.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"metricUri must be a string")}if(r!=null){if(!_.default.isInteger(r)||r<0){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"minTimestamp must be an integer that is at least 0")}}if(n!=null){if(!_.default.isInteger(n)||n<1){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"maxTimestamp must be a positive integer greater than 0")}}if(r!=null&&n!=null){if(r>=n){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"maxTimestamp must be greater than minTimestamp")}if(n-r>31536e6){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"minTimestamp and maxTimestamp can only be 1 year (365 days) apart")}}var e=E.default.get("learnerId");if(e==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getMetricsByUri called with no active learner selected.")}return}if(r==null&&n==null){n=Date.now()+864e5;r=n-31536e6}else if(r==null){r=n-31536e6;if(r<0){r=0}}else if(n==null){n=r+31536e6}var i={learnerId:e,items:[{name:t,start:r,end:n}]};var o={noCache:true};return c.default.request("POST",a.default.ENDPOINT.METRIC,i,o).then(function(e){return e})})}},{key:"getLatestInsightByUri",value:function e(t,r){return w.default.fcall(function(){_.default.checkTier(1);if(t==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"insightUri is required")}if(!_.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"insightUri must be a string")}if(r!=null){if(!_.default.isArray(r)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"contextKeys must be an array")}else{r.forEach(function(e){if(!_.default.isString(e)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"contextKeys must be an array of strings")}})}}var e=E.default.get("learnerId");if(e==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLatestInsightByUri called with no active learner selected.")}return}var n={learnerId:e,uri:t,latest:true};if(r!=null){n.contextKeys=r.join(",")}var i={noCache:true};return c.default.request("GET",a.default.ENDPOINT.INSIGHT,n,i).then(function(e){return e&&e.length?e[0]:undefined})})}},{key:"getInsights",value:function e(t,r){return w.default.fcall(function(){_.default.checkTier(1);if(t==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"minTimestamp is required")}if(!_.default.isInteger(t)||t<0){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"minTimestamp must be an integer that is at least 0")}if(r!=null){if(!_.default.isObject(r)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"contextMap must be an object")}else{Object.keys(r).forEach(function(e){if(!_.default.isString(r[e])){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"contextMap must be an object of key:value pairs with string values")}})}}var e=E.default.get("learnerId");if(e==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getInsights called with no active learner selected.")}return[]}var n={learnerId:e,minDateCreated:t};if(r!=null){Object.keys(r).forEach(function(e){n["context."+e]=r[e]})}var i={noCache:true};return c.default.request("GET",a.default.ENDPOINT.INSIGHT,n,i).then(function(e){return e})})}},{key:"startTrial",value:function e(){return v.default.addToQueue(function(){_.default.checkTier(1);var e=E.default.get("learnerId");if(e==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: startTrial called with no active learner selected.")}return}var t=Date.now();var r=E.default.get("options");if(r.tier>=3){var n=E.default.get("latentAbilities."+e)||[];var i=n.map(function(e){var r=_.default.copyObject(e);if(r.standardDeviation<.65){r.standardDeviation=.65;r.timestamp=t}return r});E.default.set("latentAbilities."+e,i)}E.default.set("trialTime",t)})}},{key:"getLatentAbilityEstimates",value:function e(){var t=this;_.default.checkTier(2);var r=E.default.get("learnerId");if(r==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLatentAbilityEstimates called with no active learner selected.")}return[]}return h.default.getDimensions().map(function(e){return t.getLatentAbilityEstimate(e&&e.uri)})}},{key:"getLatentAbilityEstimate",value:function e(t){_.default.checkTier(2);var r=E.default.get("learnerId");if(r==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLatentAbilityEstimate called with no active learner selected.")}return}var n=h.default.getDimensionByUri(t);if(!n){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLatentAbilityEstimate called with an invalid dimension.")}return}var i=E.default.get("latentAbilities."+r)||[];var a=_.default.copyObject(_.default.findItem(i,function(e){return e.dimension.id===n.id}));if(a){return a}else{return{dimension:n,mean:0,standardDeviation:1,timestamp:0}}}},{key:"getLocalAbilityEstimates",value:function e(){var t=this;_.default.checkTier(2);var r=E.default.get("learnerId");if(r==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLatentAbilityEstimates called with no active learner selected.")}return[]}return h.default.getLocalDimensions().map(function(e){return t.getLocalAbilityEstimate(e&&e.uri)})}},{key:"getLocalAbilityEstimate",value:function e(t){_.default.checkTier(2);var r=E.default.get("learnerId");if(r==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLocalAbilityEstimate called with no active learner selected.")}return}var n=h.default.getLocalDimensionByUri(t);if(!n){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: getLocalAbilityEstimate called with an invalid local dimension.")}return}var i=n.dimension||{};var a=E.default.get("latentAbilities."+r)||[];var o=_.default.copyObject(_.default.findItem(a,function(e){return e.dimension.id===i.id}));if(o){return{localDimension:n,mean:o.mean,standardDeviation:o.standardDeviation,timestamp:o.timestamp}}else{return{localDimension:n,mean:0,standardDeviation:1,timestamp:0}}}},{key:"updateAbilityEstimates",value:function e(){return v.default.addToQueue(function(){_.default.checkTier(2);var e=E.default.get("learnerId");if(e==null){if(_.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: updateAbilityEstimates called with no active learner selected.")}return}var t=E.default.get("idToModel",false)||{};var r=t.dimension||{};var n=c.default.getCacheKey(c.default.getRequestSettings("GET",a.default.ENDPOINT.ABILITY,{learnerId:e}));var i=void 0;try{i=_.default.localStorageGetItem(n)||[];i.forEach(function(e){e.dimension=r[e.dimensionId];delete e.dimensionId})}catch(t){i=E.default.get("latentAbilities."+e)||[]}return c.default.request("GET",a.default.ENDPOINT.ABILITY,{learnerId:e},{noCache:true}).then(function(e){return e},function(e){return[]}).then(function(t){var n=[];t.forEach(function(e){var t=_.default.findItem(i,function(t){return t.dimension.id===e.dimensionId});if(!t||t.timestamp<e.timestamp){var a=_.default.copyObject(e);a.dimension=r[a.dimensionId];delete a.dimensionId;n.push(a)}else{n.push(t)}});i.forEach(function(e){if(!_.default.findItem(n,function(t){return t.dimension.id===e.dimension.id})){n.push(e)}});E.default.set("latentAbilities."+e,n);_.default.cacheLatentAbilityEstimates(n)})})}},{key:"getSuggestedPrompts",value:function e(t,r,n,i,a){_.default.checkTier(3);var o=y.default.getRecommendation("optimalDifficulty",{localDimensionUri:t,targetSuccessProbability:r,maxResults:n,excludedPromptUris:i,includedPromptUris:a});if(o.error){throw o.error}return o.recommendations}},{key:"getRandomPromptForGame",value:function e(t,r,n,i){_.default.checkTier(3);var a=y.default.getRecommendation("random",{gameUri:t,maxResults:r,excludedPromptUris:n,includedPromptUris:i});if(a.error){throw a.error}return a.recommendations}}],[{key:"onClientSetUserSuccess",value:function e(t){_.default.cacheUser(t);_.default.cacheSingletonLearnerFlag(false);E.default.set("user",t);E.default.set("learnerId",undefined);E.default.set("singletonLearner",false)}},{key:"onServerSetUserSuccess",value:function e(t){_.default.cacheUser(t);_.default.cacheSingletonLearnerFlag(false);E.default.set("user",t);E.default.set("learnerId",undefined);E.default.set("singletonLearner",false)}},{key:"userIdDifferent",value:function e(t){var r=E.default.get("user")||_.default.getCachedUser();return r?r.id!==t:t!=null}}]);return e}();t.default=new T},function(e,t,r){"use strict";function n(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function e(t){return typeof t}}else{n=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return n(e)}function i(e){return e!==null&&n(e)==="object"}e.exports=i},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){e.deprecate=function(){};e.paths=[];if(!e.children)e.children=[];Object.defineProperty(e,"loaded",{enumerable:true,get:function(){return e.l}});Object.defineProperty(e,"id",{enumerable:true,get:function(){return e.i}});e.webpackPolyfill=1}return e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(36);var a=R(i);var o=r(4);var u=R(o);var s=r(1);var l=R(s);var f=r(6);var c=R(f);var d=r(7);var h=R(d);var p=r(2);var v=R(p);var m=r(0);var y=R(m);var g=r(3);var E=R(g);function R(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var b=null;var w=function(){function e(){_(this,e)}n(e,[{key:"reportSimpleEvent",value:function t(r,n){return h.default.addToQueue(function(){y.default.checkTier(1);if(r==null){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"EventName is required")}if(!y.default.isString(r)){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"EventName must be a string")}n=n==null?{}:n;if(!y.default.isObject(n)){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"EventFields must be an object")}n=y.default.copyObject(n);Object.keys(n).forEach(function(e){var t=n[e];if(t!==null&&!y.default.isBoolean(t)&&!y.default.isNumber(t)&&!y.default.isString(t)){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"EventField values must be a boolean, null, number, or string")}var r=t===null?null:t.toString();if(y.default.isNumber(t)&&r.indexOf("e")!==-1){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: Numeric value with large number of significant digits was converted to scientific notation.")}}n[e]=r});var t={additionalFields:y.default.copyObject(n),name:r};e.addToEventQueue(t)})}},{key:"reportRawEvent",value:function t(r){return h.default.addToQueue(function(){y.default.checkTier(1);r=y.default.copyObject(r);if(r==null){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"RawEvent is required")}if(!y.default.isString(r)){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"RawEvent must be a string")}var t={additionalFields:{raw_event_payload:r},name:"raw_custom_event"};e.addToEventQueue(t)})}},{key:"flushEventQueue",value:function t(){return h.default.addToQueue(function(){y.default.checkTier(1);var t=e.getEventQueue();if(t.length){var r=[];var n=[];t.forEach(function(e){n.push(e);r.push(c.default.request("POST",u.default.ENDPOINT.INGESTION,e,{noCache:true}))});t=[];e.setEventQueue(t);return E.default.allSettled(r).then(function(t){var r=[];for(var i=0;i<t.length;i++){var a=t[i].state==="rejected";var o=t[i].reason||{};if(a&&o.type!==l.default.ERROR_CODES.INVALID_PARAMETER){r.push(n[i])}if(r.length){var u=r.concat(e.getEventQueue());e.setEventQueue(u)}}return t})}else{return E.default.fcall(function(){return[]})}})}},{key:"startAutoFlush",value:function e(){var t=this;return h.default.addToQueue(function(){y.default.checkTier(1);clearTimeout(b);var e=v.default.get("options")||{};if(e.autoFlushInterval){b=setTimeout(function(){t.flushEventQueue().then(function(e){var r=v.default.get("options")||{};if(r.autoFlushCallback){r.autoFlushCallback.forEach(function(t){t(e)})}t.startAutoFlush()})},e.autoFlushInterval)}else{if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: ALP SDK autoFlushInterval is configured to 0. Auto flush is disabled.")}}})}},{key:"stopAutoFlush",value:function e(){return h.default.addToQueue(function(){y.default.checkTier(1);clearTimeout(b);b=null})}},{key:"setEventTransformer",value:function e(t){y.default.checkTier(3);if(t==null){v.default.set("eventTransformer");return}if(!y.default.isFunction(t)){throw new l.default(l.default.ERROR_CODES.INVALID_PARAMETER,"eventTransformer must be a function")}v.default.set("eventTransformer",t,false)}}],[{key:"addToEventQueue",value:function t(r){var n=v.default.get("options")||{};var i=v.default.get("user");if(n.authMode==="server"&&!i){throw new l.default(l.default.ERROR_CODES.ILLEGAL_STATE,"KidaptiveSdk.leanerManager.setUser must be called before sending events when using server authentication")}var o=y.default.copyObject(r);o.eventTime=Date.now();o.learnerId=v.default.get("learnerId");o.trialTime=v.default.get("trialTime");o.userId=i&&i.id;var u={version:n.version,build:n.build};var s={deviceType:window&&window.navigator&&window.navigator.userAgent,language:window&&window.navigator&&window.navigator.language};var f=e.getEventQueue();var c=y.default.findItemIndex(f,function(e){return e.appInfo.version===u.version&&e.appInfo.build===u.build&&e.deviceInfo.deviceType===s.deviceType&&e.deviceInfo.language===s.language});if(n.tier>=3){var d=v.default.get("eventTransformer",false);if(d){o=y.default.copyObject(d(o));if(!y.default.isObject(o)){return}e.validateTransformedEvent(o);if(y.default.isArray(o.attempts)){o.attempts=o.attempts.map(function(e){var t=a.default.prepareAttempt(e);if(t&&(!o.tags||!o.tags.skipIrt)){a.default.processAttempt(t)}return t||e})}}}if(c!==-1){f[c].events.push(o)}else{f.push({appInfo:u,deviceInfo:s,events:[o]})}e.setEventQueue(f)}},{key:"getEventQueue",value:function t(){var r=void 0;try{r=y.default.localStorageGetItem(e.getEventQueueCacheKey())}catch(e){r=v.default.get("eventQueue")}if(!(r instanceof Array)){r=[]}return r}},{key:"setEventQueue",value:function t(r){v.default.set("eventQueue",r);y.default.localStorageSetItem(e.getEventQueueCacheKey(),r)}},{key:"getEventQueueCacheKey",value:function e(){return c.default.getCacheKey(c.default.getRequestSettings("POST",u.default.ENDPOINT.INGESTION))}},{key:"validateTransformedEvent",value:function e(t){if(y.default.checkLoggingLevel("warn")&&console&&console.log){if(!y.default.isString(t.name)||!t.name.length){console.log("Warning: eventTransformer returned an event with name not set as a string.")}if(!y.default.isObject(t.additionalFields)||t.additionalFields===null){console.log("Warning: eventTransformer returned an event with additionalFields not set as an object.")}if(t.userId!=null&&!y.default.isNumber(t.userId)){console.log("Warning: eventTransformer returned an event with userId not set as a number.")}if(t.learnerId!=null&&!y.default.isNumber(t.learnerId)){console.log("Warning: eventTransformer returned an event with learnerId not set as a number.")}if(!y.default.isNumber(t.eventTime)){console.log("Warning: eventTransformer returned an event with eventTime not set as a number.")}if(!y.default.isNumber(t.trialTime)){console.log("Warning: eventTransformer returned an event with trialTime not set as a number.")}if(t.attempts!=null){if(!y.default.isArray(t.attempts)){console.log("Warning: eventTransformer returned an event with attempts not set as an array.")}else{t.attempts.forEach(function(e){if(!y.default.isObject(e)){console.log("Warning: eventTransformer returned an event with an attempt not set as an object.")}else{if(!y.default.isString(e.itemURI)||!e.itemURI.length){console.log("Warning: eventTransformer returned an event attempt with itemURI not set as a string.")}if(!y.default.isNumber(e.outcome)){console.log("Warning: eventTransformer returned an event attempt with outcome not set as a numeric value.")}else if(e.outcome<0||e.outcome>1){console.log("Warning: eventTransformer returned an event attempt with outcome not set as a value between or equal to 0 and 1.")}if(e.guessingParameter!=null&&!y.default.isNumber(e.guessingParameter)){console.log("Warning: eventTransformer returned an event attempt with guessingParameter not set as a numeric value.")}else if(e.guessingParameter!=null&&(e.guessingParameter<0||e.guessingParameter>1)){console.log("Warning: eventTransformer returned an event attempt with a guessingParameter not set as a value between or equal to 0 and 1.")}}})}}if(t.tags!=null){if(!y.default.isObject(t.tags)){console.log("Warning: eventTransformer returned an event with tags not set as an object.")}else{if(t.tags.skipIrt!=null&&!y.default.isBoolean(t.tags.skipIrt)){console.log("Warning: eventTransformer returned an event tag with skipIrt not set as a boolean.")}}}}}}]);return e}();t.default=new w},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(1);var a=s(i);var o=r(0);var u=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t){l(this,e);this.sdk=t}n(e,[{key:"getRecommendation",value:function e(t){var r=this;try{if(this.sdk.learnerManager.getActiveLearner()===undefined){throw new a.default(a.default.ERROR_CODES.ILLEGAL_STATE,"OptimalDifficulty getRecommendation called with no active learner selected.")}if(!u.default.isObject(t)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Params must be an object.")}var n=t.gameUri,i=t.excludedPromptUris,o=t.includedPromptUris;var s=t.maxResults==null?10:t.maxResults;if(n==null){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"gameUri is required.")}if(!u.default.isString(n)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"gameUri must be a string.")}var l=this.sdk.modelManager.getGameByUri(n);if(!l){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"gameUri does not map to a game.")}if(!u.default.isInteger(s)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"maxResults must be an integer.")}if(s<1){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"maxResults must be an integer greater than 0.")}if(i!=null){if(!u.default.isArray(i)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"excludedPromptUris must be an array.")}i.forEach(function(e){if(!u.default.isString(e)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"excludedPromptUris must be an array of strings.")}})}if(o!=null){if(!u.default.isArray(o)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"includedPromptUris must be an array.")}o.forEach(function(e){if(!u.default.isString(e)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"includedPromptUris must be an array of strings.")}})}var f=void 0;if(o){f=o.map(function(e){return r.sdk.modelManager.getPromptByUri(e)});f=f.filter(function(e){return e&&e.game&&e.game.uri===n})}else{f=this.sdk.modelManager.getPromptsByGameUri(n)}if(i&&i.length){f=f.filter(function(e){return i.indexOf(e.uri)===-1})}f=f.map(function(e){return{sort:Math.random(),prompt:e}}).sort(function(e,t){return e.sort-t.sort}).slice(0,s);var c=f.map(function(e){return{promptUri:e.prompt.uri}});return{recommendations:c,type:"prompt"}}catch(e){return{error:e}}}}]);return e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(1);var a=s(i);var o=r(0);var u=s(o);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var f=function(){function e(t){l(this,e);this.sdk=t}n(e,[{key:"getRecommendation",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};try{if(this.sdk.learnerManager.getActiveLearner()===undefined){throw new a.default(a.default.ERROR_CODES.ILLEGAL_STATE,"No active learner selected.")}if(!u.default.isObject(t)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"Params must be an object.")}var r=t.localDimensionUri,n=t.excludedPromptUris,i=t.includedPromptUris;var o=t.maxResults==null?10:t.maxResults;var s=t.targetSuccessProbability==null?.7:t.targetSuccessProbability;if(r==null){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"localDimensionUri is required.")}if(!u.default.isString(r)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"localDimensionUri must be a string.")}var l=this.sdk.modelManager.getLocalDimensionByUri(r);if(!l){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"localDimensionUri does not map to a local dimension.")}if(!u.default.isNumber(s)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"targetSuccessProbability must be a number.")}if(s<0||s>1){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"targetSuccessProbability must be a number between  0 and 1.")}if(!u.default.isInteger(o)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"maxResults must be an integer.")}if(o<1){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"maxResults must be an integer greater than 0.")}if(n!=null){if(!u.default.isArray(n)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"excludedPromptUris must be an array.")}n.forEach(function(e){if(!u.default.isString(e)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"excludedPromptUris must be an array of strings.")}})}if(i!=null){if(!u.default.isArray(i)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"includedPromptUris must be an array.")}i.forEach(function(e){if(!u.default.isString(e)){throw new a.default(a.default.ERROR_CODES.INVALID_PARAMETER,"includedPromptUris must be an array of strings.")}})}var f=this.sdk.learnerManager.getLocalAbilityEstimate(r);var c=this.sdk.modelManager.getItems().filter(function(e){return e.localDimension&&e.localDimension.uri===r});if(i){c=c.filter(function(e){return i.indexOf(e.prompt&&e.prompt.uri)!==-1})}if(n&&n.length){c=c.filter(function(e){return n.indexOf(e.prompt&&e.prompt.uri)===-1})}c=c.map(function(e){return{sort:Math.random(),item:e}}).sort(function(e,t){return e.sort-t.sort}).map(function(e){return{sort:1/(1+Math.exp(Math.sqrt(8/Math.PI)*(e.item.mean-f.mean))),item:e.item}}).sort(function(e,t){return Math.abs(e.sort-s)-Math.abs(t.sort-s)}).slice(0,o);var d=c.map(function(e){return{itemUri:e.item.uri,promptUri:e.item.prompt&&e.item.prompt.uri,successProbability:e.sort}});return{recommendations:d,type:"prompt"}}catch(e){return{error:e}}}}]);return e}();t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();function i(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function(){function e(){i(this,e)}n(e,[{key:"estimate",value:function t(r,n,i,a,o,u,s){return e.estimate(r||0,n||0,i||0,a||0,o||0,u||0,s||0)}}],[{key:"normal_dist",value:function e(t,r,n){return Math.exp(-Math.pow(t-r,2)/2/Math.pow(n,2))/n/Math.sqrt(2*Math.PI)}},{key:"logistic_dist",value:function e(t,r,n){return 1/(1+Math.exp(-n*(t-r)))}},{key:"inv_logis",value:function e(t){return Math.log(1/t-1)*Math.sqrt(Math.PI/8)}},{key:"estimate",value:function t(r,n,i,a,o,u,s){var l=Math.sqrt(8/Math.PI);var f=2/l;u=a;s=o=Math.min(Math.max(o,0),f);if(o===0){return{post_mean:u,post_sd:s}}r=r<.5?0:1;if(i>=1){return{post_mean:u,post_sd:s}}else{i=Math.max(i,0)}var c=void 0;var d=void 0;var h=void 0;var p=Infinity;var v=-Infinity;var m=1;var y=void 0;var g=void 0;var E=void 0;do{h=u;y=e.logistic_dist(u,n,l);g=1-y;if(r===0||i===0){c=l*(r-y)-(u-a)*Math.pow(o,-2);d=-Math.pow(l,2)*y*g-Math.pow(o,-2)}else{E=i+(1-i)*y;c=l*y*(r-E)/E-(u-a)*Math.pow(o,-2);d=Math.pow(l,2)*y*g*(i*r-Math.pow(E,2))*Math.pow(E,-2)-Math.pow(o,-2)}if(c>0){v=u}else if(c<0){p=u}u-=c/d;if(u>=p||u<=v){if(p<Infinity&&v>-Infinity){u=(p+v)/2}else if(p<Infinity){u-=m;m*=2}else{u+=m;m*=2}}}while(h!==u);s=Math.min(Math.sqrt(-1/d),f);return{post_mean:u,post_sd:s}}}]);return e}();t.default=new a},function(e,t,r){"use strict";function n(e){return o(e)||a(e)||i()}function i(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function a(e){if(Symbol.iterator in Object(e)||Object.prototype.toString.call(e)==="[object Arguments]")return Array.from(e)}function o(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++){r[t]=e[t]}return r}}function u(){this._defaults=[]}["use","on","once","set","query","type","accept","auth","withCredentials","sortQuery","retry","ok","redirects","timeout","buffer","serialize","parse","ca","key","pfx","cert"].forEach(function(e){u.prototype[e]=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++){r[n]=arguments[n]}this._defaults.push({fn:e,args:r});return this}});u.prototype._setDefaults=function(e){this._defaults.forEach(function(t){e[t.fn].apply(e,n(t.args))})};e.exports=u},function(e,t,r){"use strict";t.type=function(e){return e.split(/ *; */).shift()};t.params=function(e){return e.split(/ *; */).reduce(function(e,t){var r=t.split(/ *= */);var n=r.shift();var i=r.shift();if(n&&i)e[n]=i;return e},{})};t.parseLinks=function(e){return e.split(/ *, */).reduce(function(e,t){var r=t.split(/ *; */);var n=r[0].slice(1,-1);var i=r[1].split(/ *= */)[1].slice(1,-1);e[i]=n;return e},{})};t.cleanHeader=function(e,t){delete e["content-type"];delete e["content-length"];delete e["transfer-encoding"];delete e.host;if(t){delete e.authorization;delete e.cookie}return e}},function(e,t,r){"use strict";var n=r(19);e.exports=i;function i(e){if(e)return a(e)}function a(e){for(var t in i.prototype){if(Object.prototype.hasOwnProperty.call(i.prototype,t))e[t]=i.prototype[t]}return e}i.prototype.get=function(e){return this.header[e.toLowerCase()]};i.prototype._setHeaderProperties=function(e){var t=e["content-type"]||"";this.type=n.type(t);var r=n.params(t);for(var i in r){if(Object.prototype.hasOwnProperty.call(r,i))this[i]=r[i]}this.links={};try{if(e.link){this.links=n.parseLinks(e.link)}}catch(e){}};i.prototype._setStatusProperties=function(e){var t=e/100|0;this.statusCode=e;this.status=this.statusCode;this.statusType=t;this.info=t===1;this.ok=t===2;this.redirect=t===3;this.clientError=t===4;this.serverError=t===5;this.error=t===4||t===5?this.toError():false;this.created=e===201;this.accepted=e===202;this.noContent=e===204;this.badRequest=e===400;this.unauthorized=e===401;this.notAcceptable=e===406;this.forbidden=e===403;this.notFound=e===404;this.unprocessableEntity=e===422}},function(e,t,r){"use strict";function n(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function e(t){return typeof t}}else{n=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return n(e)}var i=r(12);e.exports=a;function a(e){if(e)return o(e)}function o(e){for(var t in a.prototype){if(Object.prototype.hasOwnProperty.call(a.prototype,t))e[t]=a.prototype[t]}return e}a.prototype.clearTimeout=function(){clearTimeout(this._timer);clearTimeout(this._responseTimeoutTimer);clearTimeout(this._uploadTimeoutTimer);delete this._timer;delete this._responseTimeoutTimer;delete this._uploadTimeoutTimer;return this};a.prototype.parse=function(e){this._parser=e;return this};a.prototype.responseType=function(e){this._responseType=e;return this};a.prototype.serialize=function(e){this._serializer=e;return this};a.prototype.timeout=function(e){if(!e||n(e)!=="object"){this._timeout=e;this._responseTimeout=0;this._uploadTimeout=0;return this}for(var t in e){if(Object.prototype.hasOwnProperty.call(e,t)){switch(t){case"deadline":this._timeout=e.deadline;break;case"response":this._responseTimeout=e.response;break;case"upload":this._uploadTimeout=e.upload;break;default:console.warn("Unknown timeout option",t)}}}return this};a.prototype.retry=function(e,t){if(arguments.length===0||e===true)e=1;if(e<=0)e=0;this._maxRetries=e;this._retries=0;this._retryCallback=t;return this};var u=["ECONNRESET","ETIMEDOUT","EADDRINFO","ESOCKETTIMEDOUT"];a.prototype._shouldRetry=function(e,t){if(!this._maxRetries||this._retries++>=this._maxRetries){return false}if(this._retryCallback){try{var r=this._retryCallback(e,t);if(r===true)return true;if(r===false)return false}catch(e){console.error(e)}}if(t&&t.status&&t.status>=500&&t.status!==501)return true;if(e){if(e.code&&u.indexOf(e.code)!==-1)return true;if(e.timeout&&e.code==="ECONNABORTED")return true;if(e.crossDomain)return true}return false};a.prototype._retry=function(){this.clearTimeout();if(this.req){this.req=null;this.req=this.request()}this._aborted=false;this.timedout=false;return this._end()};a.prototype.then=function(e,t){var r=this;if(!this._fullfilledPromise){var n=this;if(this._endCalled){console.warn("Warning: superagent request was sent twice, because both .end() and .then() were called. Never call .end() if you use promises")}this._fullfilledPromise=new Promise(function(e,t){n.on("abort",function(){var e=new Error("Aborted");e.code="ABORTED";e.status=r.status;e.method=r.method;e.url=r.url;t(e)});n.end(function(r,n){if(r)t(r);else e(n)})})}return this._fullfilledPromise.then(e,t)};a.prototype.catch=function(e){return this.then(undefined,e)};a.prototype.use=function(e){e(this);return this};a.prototype.ok=function(e){if(typeof e!=="function")throw new Error("Callback required");this._okCallback=e;return this};a.prototype._isResponseOK=function(e){if(!e){return false}if(this._okCallback){return this._okCallback(e)}return e.status>=200&&e.status<300};a.prototype.get=function(e){return this._header[e.toLowerCase()]};a.prototype.getHeader=a.prototype.get;a.prototype.set=function(e,t){if(i(e)){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))this.set(r,e[r])}return this}this._header[e.toLowerCase()]=t;this.header[e]=t;return this};a.prototype.unset=function(e){delete this._header[e.toLowerCase()];delete this.header[e];return this};a.prototype.field=function(e,t){if(e===null||undefined===e){throw new Error(".field(name, val) name can not be empty")}if(this._data){throw new Error(".field() can't be used if .send() is used. Please use only .send() or only .field() & .attach()")}if(i(e)){for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))this.field(r,e[r])}return this}if(Array.isArray(t)){for(var n in t){if(Object.prototype.hasOwnProperty.call(t,n))this.field(e,t[n])}return this}if(t===null||undefined===t){throw new Error(".field(name, val) val can not be empty")}if(typeof t==="boolean"){t=String(t)}this._getFormData().append(e,t);return this};a.prototype.abort=function(){if(this._aborted){return this}this._aborted=true;if(this.xhr)this.xhr.abort();if(this.req)this.req.abort();this.clearTimeout();this.emit("abort");return this};a.prototype._auth=function(e,t,r,n){switch(r.type){case"basic":this.set("Authorization","Basic ".concat(n("".concat(e,":").concat(t))));break;case"auto":this.username=e;this.password=t;break;case"bearer":this.set("Authorization","Bearer ".concat(e));break;default:break}return this};a.prototype.withCredentials=function(e){if(e===undefined)e=true;this._withCredentials=e;return this};a.prototype.redirects=function(e){this._maxRedirects=e;return this};a.prototype.maxResponseSize=function(e){if(typeof e!=="number"){throw new TypeError("Invalid argument")}this._maxResponseSize=e;return this};a.prototype.toJSON=function(){return{method:this.method,url:this.url,data:this._data,headers:this._header}};a.prototype.send=function(e){var t=i(e);var r=this._header["content-type"];if(this._formData){throw new Error(".send() can't be used if .attach() or .field() is used. Please use only .send() or only .field() & .attach()")}if(t&&!this._data){if(Array.isArray(e)){this._data=[]}else if(!this._isHost(e)){this._data={}}}else if(e&&this._data&&this._isHost(this._data)){throw new Error("Can't merge these send calls")}if(t&&i(this._data)){for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n))this._data[n]=e[n]}}else if(typeof e==="string"){if(!r)this.type("form");r=this._header["content-type"];if(r==="application/x-www-form-urlencoded"){this._data=this._data?"".concat(this._data,"&").concat(e):e}else{this._data=(this._data||"")+e}}else{this._data=e}if(!t||this._isHost(e)){return this}if(!r)this.type("json");return this};a.prototype.sortQuery=function(e){this._sort=typeof e==="undefined"?true:e;return this};a.prototype._finalizeQueryString=function(){var e=this._query.join("&");if(e){this.url+=(this.url.indexOf("?")>=0?"&":"?")+e}this._query.length=0;if(this._sort){var t=this.url.indexOf("?");if(t>=0){var r=this.url.substring(t+1).split("&");if(typeof this._sort==="function"){r.sort(this._sort)}else{r.sort()}this.url=this.url.substring(0,t)+"?"+r.join("&")}}};a.prototype._appendQueryString=function(){console.warn("Unsupported")};a.prototype._timeoutError=function(e,t,r){if(this._aborted){return}var n=new Error("".concat(e+t,"ms exceeded"));n.timeout=t;n.code="ECONNABORTED";n.errno=r;this.timedout=true;this.abort();this.callback(n)};a.prototype._setTimeouts=function(){var e=this;if(this._timeout&&!this._timer){this._timer=setTimeout(function(){e._timeoutError("Timeout of ",e._timeout,"ETIME")},this._timeout)}if(this._responseTimeout&&!this._responseTimeoutTimer){this._responseTimeoutTimer=setTimeout(function(){e._timeoutError("Response timeout of ",e._responseTimeout,"ETIMEDOUT")},this._responseTimeout)}}},function(e,t){e.exports=n;n.default=n;n.stable=o;n.stableStringify=o;var r=[];function n(e,t,n){i(e,"",[],undefined);var a=JSON.stringify(e,t,n);while(r.length!==0){var o=r.pop();o[0][o[1]]=o[2]}return a}function i(e,t,n,a){var o;if(typeof e==="object"&&e!==null){for(o=0;o<n.length;o++){if(n[o]===e){a[t]="[Circular]";r.push([a,t,e]);return}}n.push(e);if(Array.isArray(e)){for(o=0;o<e.length;o++){i(e[o],o,n,e)}}else{var u=Object.keys(e);for(o=0;o<u.length;o++){var s=u[o];i(e[s],s,n,e)}}n.pop()}}function a(e,t){if(e<t){return-1}if(e>t){return 1}return 0}function o(e,t,n){var i=u(e,"",[],undefined)||e;var a=JSON.stringify(i,t,n);while(r.length!==0){var o=r.pop();o[0][o[1]]=o[2]}return a}function u(e,t,n,i){var o;if(typeof e==="object"&&e!==null){for(o=0;o<n.length;o++){if(n[o]===e){i[t]="[Circular]";r.push([i,t,e]);return}}if(typeof e.toJSON==="function"){return}n.push(e);if(Array.isArray(e)){for(o=0;o<e.length;o++){u(e[o],o,n,e)}}else{var s={};var l=Object.keys(e).sort(a);for(o=0;o<l.length;o++){var f=l[o];u(e[f],f,n,e);s[f]=e[f]}if(i!==undefined){r.push([i,t,e]);i[t]=s}else{return s}}n.pop()}}},function(e,t,r){if(true){e.exports=n}function n(e){if(e)return i(e)}function i(e){for(var t in n.prototype){e[t]=n.prototype[t]}return e}n.prototype.on=n.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t);return this};n.prototype.once=function(e,t){function r(){this.off(e,r);t.apply(this,arguments)}r.fn=t;this.on(e,r);return this};n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length){delete this._callbacks["$"+e];return this}var n;for(var i=0;i<r.length;i++){n=r[i];if(n===t||n.fn===t){r.splice(i,1);break}}if(r.length===0){delete this._callbacks["$"+e]}return this};n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=new Array(arguments.length-1),r=this._callbacks["$"+e];for(var n=1;n<arguments.length;n++){t[n-1]=arguments[n]}if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n){r[n].apply(this,t)}}return this};n.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,r){"use strict";function n(e){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){n=function e(t){return typeof t}}else{n=function e(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return n(e)}var i;if(typeof window!=="undefined"){i=window}else if(typeof self==="undefined"){console.warn("Using browser-only version of superagent in non-browser environment");i=void 0}else{i=self}var a=r(23);var o=r(22);var u=r(21);var s=r(12);var l=r(20);var f=r(18);function c(){}e.exports=function(e,r){if(typeof r==="function"){return new t.Request("GET",e).end(r)}if(arguments.length===1){return new t.Request("GET",e)}return new t.Request(e,r)};t=e.exports;var d=t;t.Request=R;d.getXHR=function(){if(i.XMLHttpRequest&&(!i.location||i.location.protocol!=="file:"||!i.ActiveXObject)){return new XMLHttpRequest}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}throw new Error("Browser-only version of superagent could not find XHR")};var h="".trim?function(e){return e.trim()}:function(e){return e.replace(/(^\s*|\s*$)/g,"")};function p(e){if(!s(e))return e;var t=[];for(var r in e){if(Object.prototype.hasOwnProperty.call(e,r))v(t,r,e[r])}return t.join("&")}function v(e,t,r){if(r===undefined)return;if(r===null){e.push(encodeURIComponent(t));return}if(Array.isArray(r)){r.forEach(function(r){v(e,t,r)})}else if(s(r)){for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n))v(e,"".concat(t,"[").concat(n,"]"),r[n])}}else{e.push(encodeURIComponent(t)+"="+encodeURIComponent(r))}}d.serializeObject=p;function m(e){var t={};var r=e.split("&");var n;var i;for(var a=0,o=r.length;a<o;++a){n=r[a];i=n.indexOf("=");if(i===-1){t[decodeURIComponent(n)]=""}else{t[decodeURIComponent(n.slice(0,i))]=decodeURIComponent(n.slice(i+1))}}return t}d.parseString=m;d.types={html:"text/html",json:"application/json",xml:"text/xml",urlencoded:"application/x-www-form-urlencoded",form:"application/x-www-form-urlencoded","form-data":"application/x-www-form-urlencoded"};d.serialize={"application/x-www-form-urlencoded":p,"application/json":o};d.parse={"application/x-www-form-urlencoded":m,"application/json":JSON.parse};function y(e){var t=e.split(/\r?\n/);var r={};var n;var i;var a;var o;for(var u=0,s=t.length;u<s;++u){i=t[u];n=i.indexOf(":");if(n===-1){continue}a=i.slice(0,n).toLowerCase();o=h(i.slice(n+1));r[a]=o}return r}function g(e){return/[/+]json($|[^-\w])/.test(e)}function E(e){this.req=e;this.xhr=this.req.xhr;this.text=this.req.method!=="HEAD"&&(this.xhr.responseType===""||this.xhr.responseType==="text")||typeof this.xhr.responseType==="undefined"?this.xhr.responseText:null;this.statusText=this.req.xhr.statusText;var t=this.xhr.status;if(t===1223){t=204}this._setStatusProperties(t);this.headers=y(this.xhr.getAllResponseHeaders());this.header=this.headers;this.header["content-type"]=this.xhr.getResponseHeader("content-type");this._setHeaderProperties(this.header);if(this.text===null&&e._responseType){this.body=this.xhr.response}else{this.body=this.req.method==="HEAD"?null:this._parseBody(this.text?this.text:this.xhr.response)}}l(E.prototype);E.prototype._parseBody=function(e){var t=d.parse[this.type];if(this.req._parser){return this.req._parser(this,e)}if(!t&&g(this.type)){t=d.parse["application/json"]}return t&&e&&(e.length>0||e instanceof Object)?t(e):null};E.prototype.toError=function(){var e=this.req;var t=e.method;var r=e.url;var n="cannot ".concat(t," ").concat(r," (").concat(this.status,")");var i=new Error(n);i.status=this.status;i.method=t;i.url=r;return i};d.Response=E;function R(e,t){var r=this;this._query=this._query||[];this.method=e;this.url=t;this.header={};this._header={};this.on("end",function(){var e=null;var t=null;try{t=new E(r)}catch(t){e=new Error("Parser is unable to parse the response");e.parse=true;e.original=t;if(r.xhr){e.rawResponse=typeof r.xhr.responseType==="undefined"?r.xhr.responseText:r.xhr.response;e.status=r.xhr.status?r.xhr.status:null;e.statusCode=e.status}else{e.rawResponse=null;e.status=null}return r.callback(e)}r.emit("response",t);var n;try{if(!r._isResponseOK(t)){n=new Error(t.statusText||"Unsuccessful HTTP response")}}catch(e){n=e}if(n){n.original=e;n.response=t;n.status=t.status;r.callback(n,t)}else{r.callback(null,t)}})}a(R.prototype);u(R.prototype);R.prototype.type=function(e){this.set("Content-Type",d.types[e]||e);return this};R.prototype.accept=function(e){this.set("Accept",d.types[e]||e);return this};R.prototype.auth=function(e,t,r){if(arguments.length===1)t="";if(n(t)==="object"&&t!==null){r=t;t=""}if(!r){r={type:typeof btoa==="function"?"basic":"auto"}}var i=function e(t){if(typeof btoa==="function"){return btoa(t)}throw new Error("Cannot use basic auth, btoa is not a function")};return this._auth(e,t,r,i)};R.prototype.query=function(e){if(typeof e!=="string")e=p(e);if(e)this._query.push(e);return this};R.prototype.attach=function(e,t,r){if(t){if(this._data){throw new Error("superagent can't mix .send() and .attach()")}this._getFormData().append(e,t,r||t.name)}return this};R.prototype._getFormData=function(){if(!this._formData){this._formData=new i.FormData}return this._formData};R.prototype.callback=function(e,t){if(this._shouldRetry(e,t)){return this._retry()}var r=this._callback;this.clearTimeout();if(e){if(this._maxRetries)e.retries=this._retries-1;this.emit("error",e)}r(e,t)};R.prototype.crossDomainError=function(){var e=new Error("Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.");e.crossDomain=true;e.status=this.status;e.method=this.method;e.url=this.url;this.callback(e)};R.prototype.agent=function(){console.warn("This is not supported in browser version of superagent");return this};R.prototype.buffer=R.prototype.ca;R.prototype.ca=R.prototype.agent;R.prototype.write=function(){throw new Error("Streaming is not supported in browser version of superagent")};R.prototype.pipe=R.prototype.write;R.prototype._isHost=function(e){return e&&n(e)==="object"&&!Array.isArray(e)&&Object.prototype.toString.call(e)!=="[object Object]"};R.prototype.end=function(e){if(this._endCalled){console.warn("Warning: .end() was called twice. This is not supported in superagent")}this._endCalled=true;this._callback=e||c;this._finalizeQueryString();this._end()};R.prototype._setUploadTimeout=function(){var e=this;if(this._uploadTimeout&&!this._uploadTimeoutTimer){this._uploadTimeoutTimer=setTimeout(function(){e._timeoutError("Upload timeout of ",e._uploadTimeout,"ETIMEDOUT")},this._uploadTimeout)}};R.prototype._end=function(){if(this._aborted)return this.callback(new Error("The request has been aborted even before .end() was called"));var e=this;this.xhr=d.getXHR();var t=this.xhr;var r=this._formData||this._data;this._setTimeouts();t.onreadystatechange=function(){var r=t.readyState;if(r>=2&&e._responseTimeoutTimer){clearTimeout(e._responseTimeoutTimer)}if(r!==4){return}var n;try{n=t.status}catch(e){n=0}if(!n){if(e.timedout||e._aborted)return;return e.crossDomainError()}e.emit("end")};var n=function t(r,n){if(n.total>0){n.percent=n.loaded/n.total*100;if(n.percent===100){clearTimeout(e._uploadTimeoutTimer)}}n.direction=r;e.emit("progress",n)};if(this.hasListeners("progress")){try{t.addEventListener("progress",n.bind(null,"download"));if(t.upload){t.upload.addEventListener("progress",n.bind(null,"upload"))}}catch(e){}}if(t.upload){this._setUploadTimeout()}try{if(this.username&&this.password){t.open(this.method,this.url,true,this.username,this.password)}else{t.open(this.method,this.url,true)}}catch(e){return this.callback(e)}if(this._withCredentials)t.withCredentials=true;if(!this._formData&&this.method!=="GET"&&this.method!=="HEAD"&&typeof r!=="string"&&!this._isHost(r)){var i=this._header["content-type"];var a=this._serializer||d.serialize[i?i.split(";")[0]:""];if(!a&&g(i)){a=d.serialize["application/json"]}if(a)r=a(r)}for(var o in this.header){if(this.header[o]===null)continue;if(Object.prototype.hasOwnProperty.call(this.header,o))t.setRequestHeader(o,this.header[o])}if(this._responseType){t.responseType=this._responseType}this.emit("request",this);t.send(typeof r==="undefined"?null:r)};d.agent=function(){return new f};["GET","POST","OPTIONS","PATCH","PUT","DELETE"].forEach(function(e){f.prototype[e.toLowerCase()]=function(t,r){var n=new d.Request(e,t);this._setDefaults(n);if(r){n.end(r)}return n}});f.prototype.del=f.prototype.delete;d.get=function(e,t,r){var n=d("GET",e);if(typeof t==="function"){r=t;t=null}if(t)n.query(t);if(r)n.end(r);return n};d.head=function(e,t,r){var n=d("HEAD",e);if(typeof t==="function"){r=t;t=null}if(t)n.query(t);if(r)n.end(r);return n};d.options=function(e,t,r){var n=d("OPTIONS",e);if(typeof t==="function"){r=t;t=null}if(t)n.send(t);if(r)n.end(r);return n};function _(e,t,r){var n=d("DELETE",e);if(typeof t==="function"){r=t;t=null}if(t)n.send(t);if(r)n.end(r);return n}d.del=_;d.delete=_;d.patch=function(e,t,r){var n=d("PATCH",e);if(typeof t==="function"){r=t;t=null}if(t)n.send(t);if(r)n.end(r);return n};d.post=function(e,t,r){var n=d("POST",e);if(typeof t==="function"){r=t;t=null}if(t)n.send(t);if(r)n.end(r);return n};d.put=function(e,t,r){var n=d("PUT",e);if(typeof t==="function"){r=t;t=null}if(t)n.send(t);if(r)n.end(r);return n}},function(e,t,r){"use strict";var n=r(3);var i=r(24);function a(e){return function(){var t=e.apply(i,arguments);var r=t.end;t.end=function(){var e=n.defer();t.on("progress",function(t){e.notify(t)});r.call(t,function(t,r){if(t)return e.reject(t);e.resolve(r)});return e.promise};return t}}var o=a(i);o.get=a(i.get);o.put=a(i.put);o.post=a(i.post);o.del=a(i.del);o.head=a(i.head);e.exports=o},function(e,t,r){(function(e,t){(function(e,r){"use strict";if(e.setImmediate){return}var n=1;var i={};var a=false;var o=e.document;var u;function s(e){if(typeof e!=="function"){e=new Function(""+e)}var t=new Array(arguments.length-1);for(var r=0;r<t.length;r++){t[r]=arguments[r+1]}var a={callback:e,args:t};i[n]=a;u(n);return n++}function l(e){delete i[e]}function f(e){var t=e.callback;var n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n);break}}function c(e){if(a){setTimeout(c,0,e)}else{var t=i[e];if(t){a=true;try{f(t)}finally{l(e);a=false}}}}function d(){u=function(e){t.nextTick(function(){c(e)})}}function h(){if(e.postMessage&&!e.importScripts){var t=true;var r=e.onmessage;e.onmessage=function(){t=false};e.postMessage("","*");e.onmessage=r;return t}}function p(){var t="setImmediate$"+Math.random()+"$";var r=function(r){if(r.source===e&&typeof r.data==="string"&&r.data.indexOf(t)===0){c(+r.data.slice(t.length))}};if(e.addEventListener){e.addEventListener("message",r,false)}else{e.attachEvent("onmessage",r)}u=function(r){e.postMessage(t+r,"*")}}function v(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;c(t)};u=function(t){e.port2.postMessage(t)}}function m(){var e=o.documentElement;u=function(t){var r=o.createElement("script");r.onreadystatechange=function(){c(t);r.onreadystatechange=null;e.removeChild(r);r=null};e.appendChild(r)}}function y(){u=function(e){setTimeout(c,0,e)}}var g=Object.getPrototypeOf&&Object.getPrototypeOf(e);g=g&&g.setTimeout?g:e;if({}.toString.call(e.process)==="[object process]"){d()}else if(h()){p()}else if(e.MessageChannel){v()}else if(o&&"onreadystatechange"in o.createElement("script")){m()}else{y()}g.setImmediate=s;g.clearImmediate=l})(typeof self==="undefined"?typeof e==="undefined"?this:e:self)}).call(this,r(5),r(9))},function(e,t,r){(function(e){var n=Function.prototype.apply;t.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)};t.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)};t.clearTimeout=t.clearInterval=function(e){if(e){e.close()}};function i(e,t){this._id=e;this._clearFn=t}i.prototype.unref=i.prototype.ref=function(){};i.prototype.close=function(){this._clearFn.call(window,this._id)};t.enroll=function(e,t){clearTimeout(e._idleTimeoutId);e._idleTimeout=t};t.unenroll=function(e){clearTimeout(e._idleTimeoutId);e._idleTimeout=-1};t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;if(t>=0){e._idleTimeoutId=setTimeout(function t(){if(e._onTimeout)e._onTimeout()},t)}};r(26);t.setImmediate=typeof self!=="undefined"&&self.setImmediate||typeof e!=="undefined"&&e.setImmediate||this&&this.setImmediate;t.clearImmediate=typeof self!=="undefined"&&self.clearImmediate||typeof e!=="undefined"&&e.clearImmediate||this&&this.clearImmediate}).call(this,r(5))},function(e,t){(function(t){e.exports=t}).call(this,{})},function(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;(function(){"use strict";var ERROR="input is invalid type";var WINDOW=typeof window==="object";var root=WINDOW?window:{};if(root.JS_SHA256_NO_WINDOW){WINDOW=false}var WEB_WORKER=!WINDOW&&typeof self==="object";var NODE_JS=!root.JS_SHA256_NO_NODE_JS&&typeof process==="object"&&process.versions&&process.versions.node;if(NODE_JS){root=global}else if(WEB_WORKER){root=self}var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&typeof module==="object"&&module.exports;var AMD="function"==="function"&&__webpack_require__(28);var ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&typeof ArrayBuffer!=="undefined";var HEX_CHARS="0123456789abcdef".split("");var EXTRA=[-2147483648,8388608,32768,128];var SHIFT=[24,16,8,0];var K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];var OUTPUT_TYPES=["hex","array","digest","arrayBuffer"];var blocks=[];if(root.JS_SHA256_NO_NODE_JS||!Array.isArray){Array.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}if(ARRAY_BUFFER&&(root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)){ArrayBuffer.isView=function(e){return typeof e==="object"&&e.buffer&&e.buffer.constructor===ArrayBuffer}}var createOutputMethod=function(e,t){return function(r){return new Sha256(t,true).update(r)[e]()}};var createMethod=function(e){var t=createOutputMethod("hex",e);if(NODE_JS){t=nodeWrap(t,e)}t.create=function(){return new Sha256(e)};t.update=function(e){return t.create().update(e)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createOutputMethod(n,e)}return t};var nodeWrap=function(method,is224){var crypto=eval("require('crypto')");var Buffer=eval("require('buffer').Buffer");var algorithm=is224?"sha224":"sha256";var nodeMethod=function(e){if(typeof e==="string"){return crypto.createHash(algorithm).update(e,"utf8").digest("hex")}else{if(e===null||e===undefined){throw new Error(ERROR)}else if(e.constructor===ArrayBuffer){e=new Uint8Array(e)}}if(Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer){return crypto.createHash(algorithm).update(new Buffer(e)).digest("hex")}else{return method(e)}};return nodeMethod};var createHmacOutputMethod=function(e,t){return function(r,n){return new HmacSha256(r,t,true).update(n)[e]()}};var createHmacMethod=function(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e)};t.update=function(e,r){return t.create(e).update(r)};for(var r=0;r<OUTPUT_TYPES.length;++r){var n=OUTPUT_TYPES[r];t[n]=createHmacOutputMethod(n,e)}return t};function Sha256(e,t){if(t){blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0;this.blocks=blocks}else{this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}if(e){this.h0=3238371032;this.h1=914150663;this.h2=812702999;this.h3=4144912697;this.h4=4290775857;this.h5=1750603025;this.h6=1694076839;this.h7=3204075428}else{this.h0=1779033703;this.h1=3144134277;this.h2=1013904242;this.h3=2773480762;this.h4=1359893119;this.h5=2600822924;this.h6=528734635;this.h7=1541459225}this.block=this.start=this.bytes=this.hBytes=0;this.finalized=this.hashed=false;this.first=true;this.is224=e}Sha256.prototype.update=function(e){if(this.finalized){return}var t,r=typeof e;if(r!=="string"){if(r==="object"){if(e===null){throw new Error(ERROR)}else if(ARRAY_BUFFER&&e.constructor===ArrayBuffer){e=new Uint8Array(e)}else if(!Array.isArray(e)){if(!ARRAY_BUFFER||!ArrayBuffer.isView(e)){throw new Error(ERROR)}}}else{throw new Error(ERROR)}t=true}var n,i=0,a,o=e.length,u=this.blocks;while(i<o){if(this.hashed){this.hashed=false;u[0]=this.block;u[16]=u[1]=u[2]=u[3]=u[4]=u[5]=u[6]=u[7]=u[8]=u[9]=u[10]=u[11]=u[12]=u[13]=u[14]=u[15]=0}if(t){for(a=this.start;i<o&&a<64;++i){u[a>>2]|=e[i]<<SHIFT[a++&3]}}else{for(a=this.start;i<o&&a<64;++i){n=e.charCodeAt(i);if(n<128){u[a>>2]|=n<<SHIFT[a++&3]}else if(n<2048){u[a>>2]|=(192|n>>6)<<SHIFT[a++&3];u[a>>2]|=(128|n&63)<<SHIFT[a++&3]}else if(n<55296||n>=57344){u[a>>2]|=(224|n>>12)<<SHIFT[a++&3];u[a>>2]|=(128|n>>6&63)<<SHIFT[a++&3];u[a>>2]|=(128|n&63)<<SHIFT[a++&3]}else{n=65536+((n&1023)<<10|e.charCodeAt(++i)&1023);u[a>>2]|=(240|n>>18)<<SHIFT[a++&3];u[a>>2]|=(128|n>>12&63)<<SHIFT[a++&3];u[a>>2]|=(128|n>>6&63)<<SHIFT[a++&3];u[a>>2]|=(128|n&63)<<SHIFT[a++&3]}}}this.lastByteIndex=a;this.bytes+=a-this.start;if(a>=64){this.block=u[16];this.start=a-64;this.hash();this.hashed=true}else{this.start=a}}if(this.bytes>4294967295){this.hBytes+=this.bytes/4294967296<<0;this.bytes=this.bytes%4294967296}return this};Sha256.prototype.finalize=function(){if(this.finalized){return}this.finalized=true;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block;e[t>>2]|=EXTRA[t&3];this.block=e[16];if(t>=56){if(!this.hashed){this.hash()}e[0]=this.block;e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0}e[14]=this.hBytes<<3|this.bytes>>>29;e[15]=this.bytes<<3;this.hash()};Sha256.prototype.hash=function(){var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,a=this.h5,o=this.h6,u=this.h7,s=this.blocks,l,f,c,d,h,p,v,m,y,g,E;for(l=16;l<64;++l){h=s[l-15];f=(h>>>7|h<<25)^(h>>>18|h<<14)^h>>>3;h=s[l-2];c=(h>>>17|h<<15)^(h>>>19|h<<13)^h>>>10;s[l]=s[l-16]+f+s[l-7]+c<<0}E=t&r;for(l=0;l<64;l+=4){if(this.first){if(this.is224){m=300032;h=s[0]-1413257819;u=h-150054599<<0;n=h+24177077<<0}else{m=704751109;h=s[0]-210244248;u=h-1521486534<<0;n=h+143694565<<0}this.first=false}else{f=(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10);c=(i>>>6|i<<26)^(i>>>11|i<<21)^(i>>>25|i<<7);m=e&t;d=m^e&r^E;v=i&a^~i&o;h=u+c+v+K[l]+s[l];p=f+d;u=n+h<<0;n=h+p<<0}f=(n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10);c=(u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7);y=n&e;d=y^n&t^m;v=u&i^~u&a;h=o+c+v+K[l+1]+s[l+1];p=f+d;o=r+h<<0;r=h+p<<0;f=(r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10);c=(o>>>6|o<<26)^(o>>>11|o<<21)^(o>>>25|o<<7);g=r&n;d=g^r&e^y;v=o&u^~o&i;h=a+c+v+K[l+2]+s[l+2];p=f+d;a=t+h<<0;t=h+p<<0;f=(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10);c=(a>>>6|a<<26)^(a>>>11|a<<21)^(a>>>25|a<<7);E=t&r;d=E^t&n^g;v=a&o^~a&u;h=i+c+v+K[l+3]+s[l+3];p=f+d;i=e+h<<0;e=h+p<<0}this.h0=this.h0+e<<0;this.h1=this.h1+t<<0;this.h2=this.h2+r<<0;this.h3=this.h3+n<<0;this.h4=this.h4+i<<0;this.h5=this.h5+a<<0;this.h6=this.h6+o<<0;this.h7=this.h7+u<<0};Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,a=this.h5,o=this.h6,u=this.h7;var s=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[e&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[t&15]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[r&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[n&15]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[i&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[a&15]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[o&15];if(!this.is224){s+=HEX_CHARS[u>>28&15]+HEX_CHARS[u>>24&15]+HEX_CHARS[u>>20&15]+HEX_CHARS[u>>16&15]+HEX_CHARS[u>>12&15]+HEX_CHARS[u>>8&15]+HEX_CHARS[u>>4&15]+HEX_CHARS[u&15]}return s};Sha256.prototype.toString=Sha256.prototype.hex;Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,n=this.h3,i=this.h4,a=this.h5,o=this.h6,u=this.h7;var s=[e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,n>>24&255,n>>16&255,n>>8&255,n&255,i>>24&255,i>>16&255,i>>8&255,i&255,a>>24&255,a>>16&255,a>>8&255,a&255,o>>24&255,o>>16&255,o>>8&255,o&255];if(!this.is224){s.push(u>>24&255,u>>16&255,u>>8&255,u&255)}return s};Sha256.prototype.array=Sha256.prototype.digest;Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32);var t=new DataView(e);t.setUint32(0,this.h0);t.setUint32(4,this.h1);t.setUint32(8,this.h2);t.setUint32(12,this.h3);t.setUint32(16,this.h4);t.setUint32(20,this.h5);t.setUint32(24,this.h6);if(!this.is224){t.setUint32(28,this.h7)}return e};function HmacSha256(e,t,r){var n,i=typeof e;if(i==="string"){var a=[],o=e.length,u=0,s;for(n=0;n<o;++n){s=e.charCodeAt(n);if(s<128){a[u++]=s}else if(s<2048){a[u++]=192|s>>6;a[u++]=128|s&63}else if(s<55296||s>=57344){a[u++]=224|s>>12;a[u++]=128|s>>6&63;a[u++]=128|s&63}else{s=65536+((s&1023)<<10|e.charCodeAt(++n)&1023);a[u++]=240|s>>18;a[u++]=128|s>>12&63;a[u++]=128|s>>6&63;a[u++]=128|s&63}}e=a}else{if(i==="object"){if(e===null){throw new Error(ERROR)}else if(ARRAY_BUFFER&&e.constructor===ArrayBuffer){e=new Uint8Array(e)}else if(!Array.isArray(e)){if(!ARRAY_BUFFER||!ArrayBuffer.isView(e)){throw new Error(ERROR)}}}else{throw new Error(ERROR)}}if(e.length>64){e=new Sha256(t,true).update(e).array()}var l=[],f=[];for(n=0;n<64;++n){var c=e[n]||0;l[n]=92^c;f[n]=54^c}Sha256.call(this,t,r);this.update(f);this.oKeyPad=l;this.inner=true;this.sharedMemory=r}HmacSha256.prototype=new Sha256;HmacSha256.prototype.finalize=function(){Sha256.prototype.finalize.call(this);if(this.inner){this.inner=false;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory);this.update(this.oKeyPad);this.update(e);Sha256.prototype.finalize.call(this)}};var exports=createMethod();exports.sha256=exports;exports.sha224=createMethod(true);exports.sha256.hmac=createHmacMethod();exports.sha224.hmac=createHmacMethod(true);if(COMMON_JS){module.exports=exports}else{root.sha256=exports.sha256;root.sha224=exports.sha224;if(AMD){!(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports}.call(exports,__webpack_require__,exports,module),__WEBPACK_AMD_DEFINE_RESULT__!==undefined&&(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}}})()}).call(this,__webpack_require__(9),__webpack_require__(5))},function(e,t,r){(function(e,n){var i;(function(a){var o=typeof t=="object"&&t;var u=typeof e=="object"&&e&&e.exports==o&&e;var s=typeof n=="object"&&n;if(s.global===s||s.window===s){a=s}var l=function(e){this.message=e};l.prototype=new Error;l.prototype.name="InvalidCharacterError";var f=function(e){throw new l(e)};var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var d=/[\t\n\f\r ]/g;var h=function(e){e=String(e).replace(d,"");var t=e.length;if(t%4==0){e=e.replace(/==?$/,"");t=e.length}if(t%4==1||/[^+a-zA-Z0-9/]/.test(e)){f("Invalid character: the string to be decoded is not correctly encoded.")}var r=0;var n;var i;var a="";var o=-1;while(++o<t){i=c.indexOf(e.charAt(o));n=r%4?n*64+i:i;if(r++%4){a+=String.fromCharCode(255&n>>(-2*r&6))}}return a};var p=function(e){e=String(e);if(/[^\0-\xFF]/.test(e)){f("The string to be encoded contains characters outside of the "+"Latin1 range.")}var t=e.length%3;var r="";var n=-1;var i;var a;var o;var u;var s;var l=e.length-t;while(++n<l){i=e.charCodeAt(n)<<16;a=e.charCodeAt(++n)<<8;o=e.charCodeAt(++n);s=i+a+o;r+=c.charAt(s>>18&63)+c.charAt(s>>12&63)+c.charAt(s>>6&63)+c.charAt(s&63)}if(t==2){i=e.charCodeAt(n)<<8;a=e.charCodeAt(++n);s=i+a;r+=c.charAt(s>>10)+c.charAt(s>>4&63)+c.charAt(s<<2&63)+"="}else if(t==1){s=e.charCodeAt(n);r+=c.charAt(s>>2)+c.charAt(s<<4&63)+"=="}return r};var v={encode:p,decode:h,version:"0.1.0"};if(true){!(i=function(){return v}.call(t,r,t,e),i!==undefined&&(e.exports=i))}else{var m}})(this)}).call(this,r(13)(e),r(5))},function(e,t){var r=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,i,a,o={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},u;function s(e){n.lastIndex=0;return n.test(e)?'"'+e.replace(n,function(e){var t=o[e];return typeof t==="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function l(e,t){var r,n,o,f,c=i,d,h=t[e];if(h&&typeof h==="object"&&typeof h.toJSON==="function"){h=h.toJSON(e)}if(typeof u==="function"){h=u.call(t,e,h)}switch(typeof h){case"string":return s(h);case"number":return isFinite(h)?String(h):"null";case"boolean":case"null":return String(h);case"object":if(!h)return"null";i+=a;d=[];if(Object.prototype.toString.apply(h)==="[object Array]"){f=h.length;for(r=0;r<f;r+=1){d[r]=l(r,h)||"null"}o=d.length===0?"[]":i?"[\n"+i+d.join(",\n"+i)+"\n"+c+"]":"["+d.join(",")+"]";i=c;return o}if(u&&typeof u==="object"){f=u.length;for(r=0;r<f;r+=1){n=u[r];if(typeof n==="string"){o=l(n,h);if(o){d.push(s(n)+(i?": ":":")+o)}}}}else{for(n in h){if(Object.prototype.hasOwnProperty.call(h,n)){o=l(n,h);if(o){d.push(s(n)+(i?": ":":")+o)}}}}o=d.length===0?"{}":i?"{\n"+i+d.join(",\n"+i)+"\n"+c+"}":"{"+d.join(",")+"}";i=c;return o}}e.exports=function(e,t,r){var n;i="";a="";if(typeof r==="number"){for(n=0;n<r;n+=1){a+=" "}}else if(typeof r==="string"){a=r}u=t;if(t&&typeof t!=="function"&&(typeof t!=="object"||typeof t.length!=="number")){throw new Error("JSON.stringify")}return l("",{"":e})}},function(e,t){var r,n,i={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},a,o=function(e){throw{name:"SyntaxError",message:e,at:r,text:a}},u=function(e){if(e&&e!==n){o("Expected '"+e+"' instead of '"+n+"'")}n=a.charAt(r);r+=1;return n},s=function(){var e,t="";if(n==="-"){t="-";u("-")}while(n>="0"&&n<="9"){t+=n;u()}if(n==="."){t+=".";while(u()&&n>="0"&&n<="9"){t+=n}}if(n==="e"||n==="E"){t+=n;u();if(n==="-"||n==="+"){t+=n;u()}while(n>="0"&&n<="9"){t+=n;u()}}e=+t;if(!isFinite(e)){o("Bad number")}else{return e}},l=function(){var e,t,r="",a;if(n==='"'){while(u()){if(n==='"'){u();return r}else if(n==="\\"){u();if(n==="u"){a=0;for(t=0;t<4;t+=1){e=parseInt(u(),16);if(!isFinite(e)){break}a=a*16+e}r+=String.fromCharCode(a)}else if(typeof i[n]==="string"){r+=i[n]}else{break}}else{r+=n}}}o("Bad string")},f=function(){while(n&&n<=" "){u()}},c=function(){switch(n){case"t":u("t");u("r");u("u");u("e");return true;case"f":u("f");u("a");u("l");u("s");u("e");return false;case"n":u("n");u("u");u("l");u("l");return null}o("Unexpected '"+n+"'")},d,h=function(){var e=[];if(n==="["){u("[");f();if(n==="]"){u("]");return e}while(n){e.push(d());f();if(n==="]"){u("]");return e}u(",");f()}}o("Bad array")},p=function(){var e,t={};if(n==="{"){u("{");f();if(n==="}"){u("}");return t}while(n){e=l();f();u(":");if(Object.hasOwnProperty.call(t,e)){o('Duplicate key "'+e+'"')}t[e]=d();f();if(n==="}"){u("}");return t}u(",");f()}}o("Bad object")};d=function(){f();switch(n){case"{":return p();case"[":return h();case'"':return l();case"-":return s();default:return n>="0"&&n<="9"?s():c()}};e.exports=function(e,t){var i;a=e;r=0;n=" ";i=d();f();if(n){o("Syntax error")}return typeof t==="function"?function e(r,n){var i,a,o=r[n];if(o&&typeof o==="object"){for(i in o){if(Object.prototype.hasOwnProperty.call(o,i)){a=e(o,i);if(a!==undefined){o[i]=a}else{delete o[i]}}}}return t.call(r,n,o)}({"":i},""):i}},function(e,t,r){t.parse=r(32);t.stringify=r(31)},function(e,t,r){var n=typeof JSON!=="undefined"?JSON:r(33);e.exports=function(e,t){if(!t)t={};if(typeof t==="function")t={cmp:t};var r=t.space||"";if(typeof r==="number")r=Array(r+1).join(" ");var o=typeof t.cycles==="boolean"?t.cycles:false;var u=t.replacer||function(e,t){return t};var s=t.cmp&&function(e){return function(t){return function(r,n){var i={key:r,value:t[r]};var a={key:n,value:t[n]};return e(i,a)}}}(t.cmp);var l=[];return function e(t,f,c,d){var h=r?"\n"+new Array(d+1).join(r):"";var p=r?": ":":";if(c&&c.toJSON&&typeof c.toJSON==="function"){c=c.toJSON()}c=u.call(t,f,c);if(c===undefined){return}if(typeof c!=="object"||c===null){return n.stringify(c)}if(i(c)){var v=[];for(var m=0;m<c.length;m++){var y=e(c,m,c[m],d+1)||n.stringify(null);v.push(h+r+y)}return"["+v.join(",")+h+"]"}else{if(l.indexOf(c)!==-1){if(o)return n.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else l.push(c);var g=a(c).sort(s&&s(c));var v=[];for(var m=0;m<g.length;m++){var f=g[m];var E=e(c,f,c[f],d+1);if(!E)continue;var R=n.stringify(f)+p+E;v.push(h+r+R)}l.splice(l.indexOf(c),1);return"{"+v.join(",")+h+"}"}}({"":e},"",e,0)};var i=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"};var a=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return true};var r=[];for(var n in e){if(t.call(e,n))r.push(n)}return r}},function(e,t,r){(function(e,r){var n=200;var i="__lodash_hash_undefined__";var a=9007199254740991;var o="[object Arguments]",u="[object Array]",s="[object Boolean]",l="[object Date]",f="[object Error]",c="[object Function]",d="[object GeneratorFunction]",h="[object Map]",p="[object Number]",v="[object Object]",m="[object Promise]",y="[object RegExp]",g="[object Set]",E="[object String]",R="[object Symbol]",_="[object WeakMap]";var b="[object ArrayBuffer]",w="[object DataView]",A="[object Float32Array]",O="[object Float64Array]",T="[object Int8Array]",I="[object Int16Array]",S="[object Int32Array]",k="[object Uint8Array]",L="[object Uint8ClampedArray]",D="[object Uint16Array]",C="[object Uint32Array]";var j=/[\\^$.*+?()[\]{}|]/g;var P=/\w*$/;var M=/^\[object .+?Constructor\]$/;var N=/^(?:0|[1-9]\d*)$/;var x={};x[o]=x[u]=x[b]=x[w]=x[s]=x[l]=x[A]=x[O]=x[T]=x[I]=x[S]=x[h]=x[p]=x[v]=x[y]=x[g]=x[E]=x[R]=x[k]=x[L]=x[D]=x[C]=true;x[f]=x[c]=x[_]=false;var H=typeof e=="object"&&e&&e.Object===Object&&e;var U=typeof self=="object"&&self&&self.Object===Object&&self;var V=H||U||Function("return this")();var F=typeof t=="object"&&t&&!t.nodeType&&t;var B=F&&typeof r=="object"&&r&&!r.nodeType&&r;var q=B&&B.exports===F;function X(e,t){e.set(t[0],t[1]);return e}function K(e,t){e.add(t);return e}function G(e,t){var r=-1,n=e?e.length:0;while(++r<n){if(t(e[r],r,e)===false){break}}return e}function W(e,t){var r=-1,n=t.length,i=e.length;while(++r<n){e[i+r]=t[r]}return e}function Q(e,t,r,n){var i=-1,a=e?e.length:0;if(n&&a){r=e[++i]}while(++i<a){r=t(r,e[i],i,e)}return r}function z(e,t){var r=-1,n=Array(e);while(++r<e){n[r]=t(r)}return n}function J(e,t){return e==null?undefined:e[t]}function Y(e){var t=false;if(e!=null&&typeof e.toString!="function"){try{t=!!(e+"")}catch(e){}}return t}function $(e){var t=-1,r=Array(e.size);e.forEach(function(e,n){r[++t]=[n,e]});return r}function Z(e,t){return function(r){return e(t(r))}}function ee(e){var t=-1,r=Array(e.size);e.forEach(function(e){r[++t]=e});return r}var te=Array.prototype,re=Function.prototype,ne=Object.prototype;var ie=V["__core-js_shared__"];var ae=function(){var e=/[^.]+$/.exec(ie&&ie.keys&&ie.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();var oe=re.toString;var ue=ne.hasOwnProperty;var se=ne.toString;var le=RegExp("^"+oe.call(ue).replace(j,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var fe=q?V.Buffer:undefined,ce=V.Symbol,de=V.Uint8Array,he=Z(Object.getPrototypeOf,Object),pe=Object.create,ve=ne.propertyIsEnumerable,me=te.splice;var ye=Object.getOwnPropertySymbols,ge=fe?fe.isBuffer:undefined,Ee=Z(Object.keys,Object);var Re=Tt(V,"DataView"),_e=Tt(V,"Map"),be=Tt(V,"Promise"),we=Tt(V,"Set"),Ae=Tt(V,"WeakMap"),Oe=Tt(Object,"create");var Te=Nt(Re),Ie=Nt(_e),Se=Nt(be),ke=Nt(we),Le=Nt(Ae);var De=ce?ce.prototype:undefined,Ce=De?De.valueOf:undefined;function je(e){var t=-1,r=e?e.length:0;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function Pe(){this.__data__=Oe?Oe(null):{}}function Me(e){return this.has(e)&&delete this.__data__[e]}function Ne(e){var t=this.__data__;if(Oe){var r=t[e];return r===i?undefined:r}return ue.call(t,e)?t[e]:undefined}function xe(e){var t=this.__data__;return Oe?t[e]!==undefined:ue.call(t,e)}function He(e,t){var r=this.__data__;r[e]=Oe&&t===undefined?i:t;return this}je.prototype.clear=Pe;je.prototype["delete"]=Me;je.prototype.get=Ne;je.prototype.has=xe;je.prototype.set=He;function Ue(e){var t=-1,r=e?e.length:0;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function Ve(){this.__data__=[]}function Fe(e){var t=this.__data__,r=at(t,e);if(r<0){return false}var n=t.length-1;if(r==n){t.pop()}else{me.call(t,r,1)}return true}function Be(e){var t=this.__data__,r=at(t,e);return r<0?undefined:t[r][1]}function qe(e){return at(this.__data__,e)>-1}function Xe(e,t){var r=this.__data__,n=at(r,e);if(n<0){r.push([e,t])}else{r[n][1]=t}return this}Ue.prototype.clear=Ve;Ue.prototype["delete"]=Fe;Ue.prototype.get=Be;Ue.prototype.has=qe;Ue.prototype.set=Xe;function Ke(e){var t=-1,r=e?e.length:0;this.clear();while(++t<r){var n=e[t];this.set(n[0],n[1])}}function Ge(){this.__data__={hash:new je,map:new(_e||Ue),string:new je}}function We(e){return Ot(this,e)["delete"](e)}function Qe(e){return Ot(this,e).get(e)}function ze(e){return Ot(this,e).has(e)}function Je(e,t){Ot(this,e).set(e,t);return this}Ke.prototype.clear=Ge;Ke.prototype["delete"]=We;Ke.prototype.get=Qe;Ke.prototype.has=ze;Ke.prototype.set=Je;function Ye(e){this.__data__=new Ue(e)}function $e(){this.__data__=new Ue}function Ze(e){return this.__data__["delete"](e)}function et(e){return this.__data__.get(e)}function tt(e){return this.__data__.has(e)}function rt(e,t){var r=this.__data__;if(r instanceof Ue){var i=r.__data__;if(!_e||i.length<n-1){i.push([e,t]);return this}r=this.__data__=new Ke(i)}r.set(e,t);return this}Ye.prototype.clear=$e;Ye.prototype["delete"]=Ze;Ye.prototype.get=et;Ye.prototype.has=tt;Ye.prototype.set=rt;function nt(e,t){var r=Vt(e)||Ut(e)?z(e.length,String):[];var n=r.length,i=!!n;for(var a in e){if((t||ue.call(e,a))&&!(i&&(a=="length"||Ct(a,n)))){r.push(a)}}return r}function it(e,t,r){var n=e[t];if(!(ue.call(e,t)&&Ht(n,r))||r===undefined&&!(t in e)){e[t]=r}}function at(e,t){var r=e.length;while(r--){if(Ht(e[r][0],t)){return r}}return-1}function ot(e,t){return e&&bt(t,Qt(t),e)}function ut(e,t,r,n,i,a,u){var s;if(n){s=a?n(e,i,a,u):n(e)}if(s!==undefined){return s}if(!Gt(e)){return e}var l=Vt(e);if(l){s=kt(e);if(!t){return _t(e,s)}}else{var f=St(e),h=f==c||f==d;if(qt(e)){return ht(e,t)}if(f==v||f==o||h&&!a){if(Y(e)){return a?e:{}}s=Lt(h?{}:e);if(!t){return wt(e,ot(s,e))}}else{if(!x[f]){return a?e:{}}s=Dt(e,f,ut,t)}}u||(u=new Ye);var p=u.get(e);if(p){return p}u.set(e,s);if(!l){var m=r?At(e):Qt(e)}G(m||e,function(i,a){if(m){a=i;i=e[a]}it(s,a,ut(i,t,r,n,a,e,u))});return s}function st(e){return Gt(e)?pe(e):{}}function lt(e,t,r){var n=t(e);return Vt(e)?n:W(n,r(e))}function ft(e){return se.call(e)}function ct(e){if(!Gt(e)||Pt(e)){return false}var t=Xt(e)||Y(e)?le:M;return t.test(Nt(e))}function dt(e){if(!Mt(e)){return Ee(e)}var t=[];for(var r in Object(e)){if(ue.call(e,r)&&r!="constructor"){t.push(r)}}return t}function ht(e,t){if(t){return e.slice()}var r=new e.constructor(e.length);e.copy(r);return r}function pt(e){var t=new e.constructor(e.byteLength);new de(t).set(new de(e));return t}function vt(e,t){var r=t?pt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}function mt(e,t,r){var n=t?r($(e),true):$(e);return Q(n,X,new e.constructor)}function yt(e){var t=new e.constructor(e.source,P.exec(e));t.lastIndex=e.lastIndex;return t}function gt(e,t,r){var n=t?r(ee(e),true):ee(e);return Q(n,K,new e.constructor)}function Et(e){return Ce?Object(Ce.call(e)):{}}function Rt(e,t){var r=t?pt(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function _t(e,t){var r=-1,n=e.length;t||(t=Array(n));while(++r<n){t[r]=e[r]}return t}function bt(e,t,r,n){r||(r={});var i=-1,a=t.length;while(++i<a){var o=t[i];var u=n?n(r[o],e[o],o,r,e):undefined;it(r,o,u===undefined?e[o]:u)}return r}function wt(e,t){return bt(e,It(e),t)}function At(e){return lt(e,Qt,It)}function Ot(e,t){var r=e.__data__;return jt(t)?r[typeof t=="string"?"string":"hash"]:r.map}function Tt(e,t){var r=J(e,t);return ct(r)?r:undefined}var It=ye?Z(ye,Object):zt;var St=ft;if(Re&&St(new Re(new ArrayBuffer(1)))!=w||_e&&St(new _e)!=h||be&&St(be.resolve())!=m||we&&St(new we)!=g||Ae&&St(new Ae)!=_){St=function(e){var t=se.call(e),r=t==v?e.constructor:undefined,n=r?Nt(r):undefined;if(n){switch(n){case Te:return w;case Ie:return h;case Se:return m;case ke:return g;case Le:return _}}return t}}function kt(e){var t=e.length,r=e.constructor(t);if(t&&typeof e[0]=="string"&&ue.call(e,"index")){r.index=e.index;r.input=e.input}return r}function Lt(e){return typeof e.constructor=="function"&&!Mt(e)?st(he(e)):{}}function Dt(e,t,r,n){var i=e.constructor;switch(t){case b:return pt(e);case s:case l:return new i(+e);case w:return vt(e,n);case A:case O:case T:case I:case S:case k:case L:case D:case C:return Rt(e,n);case h:return mt(e,n,r);case p:case E:return new i(e);case y:return yt(e);case g:return gt(e,n,r);case R:return Et(e)}}function Ct(e,t){t=t==null?a:t;return!!t&&(typeof e=="number"||N.test(e))&&(e>-1&&e%1==0&&e<t)}function jt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Pt(e){return!!ae&&ae in e}function Mt(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||ne;return e===r}function Nt(e){if(e!=null){try{return oe.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function xt(e){return ut(e,true,true)}function Ht(e,t){return e===t||e!==e&&t!==t}function Ut(e){return Bt(e)&&ue.call(e,"callee")&&(!ve.call(e,"callee")||se.call(e)==o)}var Vt=Array.isArray;function Ft(e){return e!=null&&Kt(e.length)&&!Xt(e)}function Bt(e){return Wt(e)&&Ft(e)}var qt=ge||Jt;function Xt(e){var t=Gt(e)?se.call(e):"";return t==c||t==d}function Kt(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=a}function Gt(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Wt(e){return!!e&&typeof e=="object"}function Qt(e){return Ft(e)?nt(e):dt(e)}function zt(){return[]}function Jt(){return false}r.exports=xt}).call(this,r(5),r(13)(e))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var a=g(i);var o=r(6);var u=g(o);var s=r(17);var l=g(s);var f=r(11);var c=g(f);var d=r(8);var h=g(d);var p=r(2);var v=g(p);var m=r(0);var y=g(m);function g(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var R=function(){function e(){E(this,e)}n(e,[{key:"prepareAttempt",value:function e(t){var r=y.default.copyObject(t);var n=v.default.get("learnerId");if(n==null){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: processAttempt called with no active learner selected. Attempt is discarded.")}return}if(!y.default.isObject(t)){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: processAttempt called with a non object attempt. Attempt will be discarded.")}return}if(!y.default.isString(t.itemURI)){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: processAttempt called with a non string itemUri. Attempt will be discarded.")}return}if(t.guessingParameter!=null&&!y.default.isNumber(t.guessingParameter)){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: processAttempt called with a non numeric guessingParamter. Attempt will be discarded.")}return}if(!y.default.isNumber(t.outcome)){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: processAttempt called with  a non numeric outcome. Attempt will be discarded.")}return}var i=h.default.getItemByUri(t.itemURI);if(!i||!i.localDimension||!i.localDimension.dimension){if(y.default.checkLoggingLevel("warn")&&console&&console.log){console.log("Warning: processAttempt called with an invalid itemUri. Attempt will be discarded.")}return}var a=c.default.getLatentAbilityEstimate(i.localDimension.dimension.uri);var o=c.default.getLocalAbilityEstimate(i.localDimension.uri);r.priorLatentMean=a.mean;r.priorLatentStandardDeviation=a.standardDeviation;r.priorLocalMean=o.mean;r.priorLocalStandardDeviation=o.standardDeviation;return r}},{key:"processAttempt",value:function e(t){var r=v.default.get("learnerId");var n=h.default.getItemByUri(t.itemURI);var i=l.default.estimate(t.outcome,n.mean,t.guessingParameter,t.priorLocalMean,t.priorLocalStandardDeviation);var a={dimension:n.localDimension.dimension,mean:i.post_mean,standardDeviation:i.post_sd,timestamp:v.default.get("trialTime")||0};var o=v.default.get("latentAbilities."+r)||[];var u=y.default.findItemIndex(o,function(e){return e.dimension&&e.dimension.uri===n.localDimension.dimension.uri});if(u!==-1){o[u]=a}else{o.push(a)}v.default.set("latentAbilities."+r,o);y.default.cacheLatentAbilityEstimates(o)}}]);return e}();t.default=new R},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i=r(4);var a=S(i);var o=r(1);var u=S(o);var s=r(14);var l=S(s);var f=r(11);var c=S(f);var d=r(8);var h=S(d);var p=r(7);var v=S(p);var m=r(10);var y=S(m);var g=r(16);var E=S(g);var R=r(15);var _=S(R);var b=r(2);var w=S(b);var A=r(0);var O=S(A);var T=r(3);var I=S(T);function S(e){return e&&e.__esModule?e:{default:e}}function k(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var L=function(){function e(){k(this,e);w.default.clear();w.default.set("initialized",false);this.eventManager=l.default;this.learnerManager=c.default;this.modelManager=h.default}n(e,[{key:"isInitialized",value:function e(){return w.default.get("initialized")}},{key:"init",value:function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return v.default.addToQueue(function(){if(w.default.get("initialized")){throw new u.default(u.default.ERROR_CODES.ILLEGAL_STATE,"SDK already initialized")}t=O.default.copyObject(t);n=O.default.copyObject(n);if(!O.default.isArray(n.autoFlushCallback)&&n.autoFlushCallback!=null){n.autoFlushCallback=[n.autoFlushCallback]}n.tier=n.tier==null?a.default.DEFAULT.TIER:n.tier;n.authMode=n.authMode==null?a.default.DEFAULT.AUTH_MODE:n.authMode;n.autoFlushInterval=n.autoFlushInterval==null?a.default.DEFAULT.AUTO_FLUSH_INTERVAL:n.autoFlushInterval;n.loggingLevel=n.loggingLevel==null?a.default.DEFAULT.LOGGING_LEVEL:n.loggingLevel;if(t==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"API key is required")}if(!O.default.isString(t)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"API key must be a string")}if(n.environment==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Environment option is required")}if(!O.default.isString(n.environment)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Environment option must be a string")}if(["dev","prod","custom"].indexOf(n.environment)===-1){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Environment option is not an accepted value")}if(n.environment==="custom"){if(n.baseUrl==null){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"BaseUrl option is required")}}if(n.baseUrl!=null&&!O.default.isString(n.baseUrl)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"BaseUrl option must be a string")}if(!O.default.isNumber(n.tier)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Tier option must be a number")}if([1,2,3].indexOf(n.tier)===-1){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Tier option is not an accepted value")}if(!O.default.isString(n.authMode)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"AuthMode option must be a string")}if(["client","server"].indexOf(n.authMode)===-1){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"AuthMode option is not an accepted value")}if(n.version!=null){if(!O.default.isString(n.version)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Version option must be a string")}}if(n.build!=null){if(!O.default.isString(n.build)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"Build option must be a string")}}if(!O.default.isNumber(n.autoFlushInterval)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"AutoFlushInterval option must be a number")}if(n.autoFlushInterval<0){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"AutoFlushInterval option is not an accepted value")}if(n.autoFlushCallback){n.autoFlushCallback.forEach(function(e){if(!O.default.isFunction(e)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"AutoFlushCallback option must be a function or array of functions")}})}if(!O.default.isString(n.loggingLevel)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"LoggingLevel option must be a string")}if(["all","warn","none"].indexOf(n.loggingLevel)===-1){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"LoggingLevel option is not an accepted value")}if(n.defaultHttpCache!=null){if(!O.default.isObject(n.defaultHttpCache)){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"defaultHttpCache must be an object")}Object.keys(n.defaultHttpCache).forEach(function(e){if(!O.default.isString(n.defaultHttpCache[e])){throw new u.default(u.default.ERROR_CODES.INVALID_PARAMETER,"defaultHttpCache must be an object of key:value pairs with string values")}});Object.keys(n.defaultHttpCache).forEach(function(e){try{O.default.localStorageGetItem(e)}catch(t){O.default.localStorageSetItem(e,n.defaultHttpCache[e],false)}})}w.default.set("initialized",true);w.default.set("apiKey",t);w.default.set("options",n);w.default.set("user",O.default.getCachedUser());w.default.set("learnerId",O.default.getCachedLearnerId());if(n.authMode==="client"){w.default.set("singletonLearner",O.default.getCachedSingletonLearnerFlag())}if(n.tier>=3){y.default.registerRecommender(new E.default(r),"optimalDifficulty");y.default.registerRecommender(new _.default(r),"random")}var e=[];if(n.tier>=1){e.push(l.default.startAutoFlush())}if(n.tier>=2){e.push(h.default.updateModels())}return I.default.all(e).then(function(e){var t=c.default.getActiveLearner();if(t){return c.default.selectActiveLearner(t.providerId).then(function(){},function(){})}else{w.default.set("learnerId",undefined)}})})}},{key:"getSdkVersion",value:function e(){return"1.1.7"}},{key:"destroy",value:function e(){return v.default.addToQueue(function(){O.default.checkInitialized();if(w.default.get("options").tier>=1){l.default.stopAutoFlush();return l.default.flushEventQueue().then(function(){w.default.clear();w.default.set("initialized",false)})}w.default.clear();w.default.set("initialized",false)})}}]);return e}();t.default=new L}])["default"]});